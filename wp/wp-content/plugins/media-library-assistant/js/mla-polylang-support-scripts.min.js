var jQuery,mla_polylang_support_vars,mlaPolylang={settings:{},utility:{getId:function(b){var c=jQuery(b).closest("tr").attr("id"),a=c.split("-");return a[a.length-1]}},inlineTranslate:null};(function(a){mlaPolylang.settings=typeof mla_polylang_support_vars==="undefined"?{}:mla_polylang_support_vars;mla_polylang_support_vars=void 0;mlaPolylang.inlineTranslate={init:function(){var c=this,d=a("#pll-quick-translate"),b=a("#pll-bulk-translate");c.type="attachment";c.what="#attachment-";d.keyup(function(f){if(f.which==27){return mlaPolylang.inlineTranslate.revert()}});a("a.cancel",d).click(function(){return mlaPolylang.inlineTranslate.revert()});a("a.save",d).click(function(){return mlaPolylang.inlineTranslate.save(this)});a("td",d).keydown(function(f){if(f.which==13){return mlaPolylang.inlineTranslate.save(this)}});a("#the-list").on("click","a.inlineTranslate",function(){mlaPolylang.inlineTranslate.edit(this);return false});a("#the-list").on("click","a.editinline",function(){a(".quick-edit-row").one("focusin",function(){mlaPolylang.inlineTranslate.openQuickEdit(this);return false});return false});b.keyup(function(f){if(f.which==27){return mlaPolylang.inlineTranslate.revert()}});a("a.cancel",b).click(function(){return mlaPolylang.inlineTranslate.revert()});a("#doaction, #doaction2").click(function(f){var g=a(this).attr("id").substr(2);if(a('select[name="'+g+'"]').val()=="pll-translate"){f.preventDefault();c.openBulkTranslate()}else{if(a("form#posts-filter tr.inline-translator").length>0){c.revert()}}});a("#post-query-submit").mousedown(function(){c.revert();a('select[name^="action"]').val("-1")})},toggle:function(c){var b=this;if("none"==a(b.what+mlaPolylang.utility.getId(c)).css("display")){b.revert()}else{b.edit(c)}},openBulkTranslate:function(){var b="",d=true;this.revert();a("#pll-bulk-translate td").attr("colspan",a("th:visible, td:visible",".widefat:first thead").length);a("table.widefat tbody").prepend(a("#pll-bulk-translate"));a("#pll-bulk-translate").addClass("inline-translator").show();a('tbody th.check-column input[type="checkbox"]').each(function(){if(a(this).prop("checked")){d=false;var e=a(this).val(),c;c=a("#inline_"+e+" .post_title").text()||mlaPolylang.settings.noTitle;b+='<div id="ttle'+e+'"><a id="_'+e+'" class="ntdelbutton" title="'+mlaPolylang.settings.ntdelTitle+'">X</a>'+c+"</div>"}});if(d){return this.revert()}a("#pll-bulk-titles").html(b);a("#pll-bulk-titles a").click(function(){var c=a(this).attr("id").substr(1);a('table.widefat input[value="'+c+'"]').prop("checked",false);a("#ttle"+c).remove()});a("#pll-bulk-translate .pll-media-action-table tr").each(function(c){a(".pll-media-action-column a",this).click(function(g){var f=a(this).attr("pll_bulk_language");a(':input[name="pll_bulk_language"]',"#pll-bulk-translate").val(f);a("#pll-bulk-translate .pll-media-action-table a").prop("disabled",true);a("#pll-bulk-translate").css("opacity","0.5");a(this).hide();return a("#pll-bulk-translate-submit","#pll-bulk-translate").click()})});a("html, body").animate({scrollTop:0},"fast")},openQuickEdit:function(e){var d,b,c;if(typeof(e)=="object"){e=mlaPolylang.utility.getId(e)}d=a("#edit-"+e);c=a(':input[name="old_lang"]',d).val();b=JSON.parse(a(':input[name="inline_translations"]',d).val());a(".pll-media-action-table tr",d).each(function(f){var h=a(this).attr("class").split("-"),g=h[h.length-1];if(g===c){a(".pll-media-action-column input",this).val(b[g]);a(this).hide()}else{if("undefined"!=typeof b[g]){a(".pll-media-action-column input",this).val(b[g]);a(".pll-media-action-column a",this).addClass("pll_icon_edit");a(".pll-media-action-column a",this).attr("title",mlaPolylang.settings.edit);a(".pll-media-action-column a",this).attr("pll_quick_language",g);a(".pll-media-action-column a",this).attr("pll_quick_id",b[g])}else{a(".pll-media-action-column input",this).val(0);a(".pll-media-action-column a",this).addClass("pll_icon_add");a(".pll-media-action-column a",this).attr("title",mlaPolylang.settings.addNew);a(".pll-media-action-column a",this).attr("pll_quick_language",g);a(".pll-media-action-column a",this).attr("pll_quick_id",0)}}a(".pll-media-action-column a",this).off("click");a(".pll-media-action-column a",this).click(function(k){var j=a(this).attr("pll_quick_language"),i=a(this).attr("pll_quick_id");a(':input[name="pll_quick_language"]',d).val(j);a(':input[name="pll_quick_id"]',d).val(i);k.preventDefault();return mlaPolylang.inlineTranslate.save(d)})});return false},edit:function(i){var d=this,b,g,f,h,c,e;d.revert();if(typeof(i)=="object"){i=mlaPolylang.utility.getId(i)}b=mlaPolylang.settings.fields;g=a("#pll-quick-translate").clone(true);a("td",g).attr("colspan",a("th:visible, td:visible",".widefat:first thead").length);if(a(d.what+i).hasClass("alternate")){a(g).addClass("alternate")}a(d.what+i).before(g);f=a("#inline_"+i);for(h=0;h<b.length;h++){a(':input[name="'+b[h]+'"]',g).val(a("."+b[h],f).text())}e=a(':input[name="old_lang"]',g).val();c=JSON.parse(a(':input[name="inline_translations"]',g).val());a(".pll-media-action-table tr",g).each(function(j){var l=a(this).attr("class").split("-"),k=l[l.length-1];if(k===e){a(".pll-media-action-column input",this).val(c[k]);a(this).hide()}else{if("undefined"!=typeof c[k]){a(".pll-media-action-column input",this).val(c[k]);a(".pll-media-action-column a",this).addClass("pll_icon_edit");a(".pll-media-action-column a",this).attr("title",mlaPolylang.settings.edit);a(".pll-media-action-column a",this).attr("pll_quick_language",k);a(".pll-media-action-column a",this).attr("pll_quick_id",c[k])}else{a(".pll-media-action-column input",this).val(0);a(".pll-media-action-column a",this).addClass("pll_icon_add");a(".pll-media-action-column a",this).attr("title",mlaPolylang.settings.addNew);a(".pll-media-action-column a",this).attr("pll_quick_language",k);a(".pll-media-action-column a",this).attr("pll_quick_id",0)}}a(".pll-media-action-column a",this).off("click");a(".pll-media-action-column a",this).click(function(o){var n=a(this).attr("pll_quick_language"),m=a(this).attr("pll_quick_id");a(':input[name="pll_quick_language"]',g).val(n);a(':input[name="pll_quick_id"]',g).val(m);return mlaPolylang.inlineTranslate.save(g)})});f=a(g).attr("id","edit-"+i).addClass("inline-translator").show().position().top;a("html, body").animate({scrollTop:f},"fast");return false},save:function(e){var d,b,c=a(".post_status_page").val()||"";if(typeof(e)=="object"){e=mlaPolylang.utility.getId(e)}if(mla.settings.useSpinnerClass){a("table.widefat .pll-quick-translate-save .spinner").addClass("is-active")}else{a("table.widefat .pll-quick-translate-save .spinner").show()}d={action:mlaPolylang.settings.ajax_action,mla_admin_nonce:mlaPolylang.settings.ajax_nonce,post_type:"attachment",post_ID:e,edit_date:"true",post_status:c};b=a("#edit-"+e+" :input").serialize();d=b+"&"+a.param(d);a.post(ajaxurl,d,function(g){var h,f,k,j,i;if(mla.settings.useSpinnerClass){a("table.widefat .pll-quick-translate-save .spinner").removeClass("is-active")}else{a("table.widefat .pll-quick-translate-save .spinner").hide()}if(g){if(-1!=g.indexOf('<tr id="attachment')){j=a(g).closest("tr");h=mlaPolylang.utility.getId(j[0]);f=a(mlaPolylang.inlineTranslate.what+h);if("undefined"!=typeof f){f.remove()}a("#edit-"+e).before(j[0]).remove();a(mlaPolylang.inlineTranslate.what+h).hide().fadeIn();if(1<j.length){for(i=1;i<j.length;i++){k=mlaPolylang.utility.getId(j[i]);f=a(mlaPolylang.inlineTranslate.what+k);if("undefined"!=typeof f){f.before(j[i]).remove();f=a(mlaPolylang.inlineTranslate.what+k);f.hide().fadeIn()}}}if(h!=e){a("a.editinline",mlaPolylang.inlineTranslate.what+h).click()}}else{g=g.replace(/<.[^<>]*?>/g,"");a("#edit-"+e+" .pll-quick-translate-save .error").html(g).show()}}else{a("#edit-"+e+" .pll-quick-translate-save .error").html(mlaPolylang.settings.error).show()}},"html");return false},revert:function(){var b=a("table.widefat tr.inline-translator ").attr("id");if(b){if(mla.settings.useSpinnerClass){a("table.widefat .pll-quick-translate-save .spinner").removeClass("is-active")}else{a("table.widefat .pll-quick-translate-save .spinner").hide()}if("pll-bulk-translate"==b){a("table.widefat #pll-bulk-translate ").removeClass("inline-translator").hide();a("#pll-bulk-titles").html("");a("#pll-inline-translate").append(a("#pll-bulk-translate"))}else{a("#"+b).remove();b=b.substr(b.lastIndexOf("-")+1);a(this.what+b).show()}}return false}};a(document).ready(function(){mlaPolylang.inlineTranslate.init()})})(jQuery);