var NestedPages,NestedPages,NestedPages,NestedPages,NestedPages,NestedPages,NestedPages,NestedPages,NestedPages,NestedPages,NestedPages,NestedPages,NestedPages,NestedPages,NestedPages,NestedPages,NestedPages,NestedPages;(NestedPages=NestedPages||{}).Formatter=function(){var plugin=this,$=jQuery;plugin.updateSubMenuToggle=function(){for(var allButtons=$(NestedPages.selectors.childToggle),i=0;i<allButtons.length;i++){var button=allButtons[i],row=$(button).parent(".row").parent("li");if($(row).children("ol").length>0){if($(row).children("ol").find("li.page-row").length<1){$(row).children("ol").hide();continue}var open,html='<div class="child-toggle-spacer"></div>';html+='<a href="#"',$(row).children("ol:visible").length>0&&(html+=' class="open"'),html+='><span class="np-icon-arrow"></span></a>',$(button).html(html),$(row).children("ol").children(".np-hide").length>0&&0===$(row).children("ol").children(".np-hide.shown").length?$(button).find("a").hide():$(row).children("ol").children(".np-hide").length>0&&$(row).children("ol").children(".np-hide.shown").length>0&&$(button).find("a").show()}else $(button).empty().html('<div class="child-toggle-spacer"></div>')}},plugin.setBorders=function(){$(NestedPages.selectors.rows).removeClass(NestedPages.cssClasses.noborder),$.each($(NestedPages.selectors.lists),(function(){$(this).find(".page-row:visible:first").addClass(NestedPages.cssClasses.noborder)}))},plugin.setNestedMargins=function(){plugin.setIndent()},plugin.setIndent=function(){var amount="1"===nestedpages.non_indent?20:30,indent_element="1"===nestedpages.non_indent?".row-inner":".child-toggle";$.each($(NestedPages.selectors.lists),(function(i,v){var parent_count=$(this).parents(NestedPages.selectors.lists).length,padding=0;if(NestedPages.jsData.sortable||(padding=10),parent_count>0){var padding=parent_count*amount+padding;$(this).find(indent_element).css("padding-left",padding+"px")}else NestedPages.jsData.sortable&&!$(this).hasClass("no-sort")?$(this).find(".row-inner").css("padding-left","0px"):$(this).find(".row-inner").css("padding-left","10px")}))},plugin.setClassicIndent=function(){$.each($(NestedPages.selectors.lists),(function(i,v){var parent_count=$(this).parents(NestedPages.selectors.lists).length,padding=0;if(NestedPages.jsData.sortable||(padding=10),parent_count>0){var padding=20*parent_count+padding;$(this).find(".row-inner").css("padding-left",padding+"px")}else NestedPages.jsData.sortable&&!$(this).hasClass("no-sort")?$(this).find(".row-inner").css("padding-left","0px"):$(this).find(".row-inner").css("padding-left","10px")}))},plugin.updatePlaceholderWidth=function(ui){if(NestedPages.jsData.nestable){var parentCount,listWidth,offset=40*$(ui.placeholder).parents("ol").length-40,newWidth=$(NestedPages.selectors.sortable).width()-offset;$(ui.placeholder).width(newWidth).css("margin-left",offset+"px")}plugin.updateListVisibility(ui)},plugin.updateListVisibility=function(ui){var parentList=$(ui.placeholder).parent("ol");$(parentList).is(":visible")||($(parentList).addClass("nplist"),$(parentList).show())},plugin.removeQuickEdit=function(){$(NestedPages.selectors.quickEditOverlay).removeClass("active").remove(),$(".sortable .quick-edit").remove(),$(".row").show()},plugin.showQuickEdit=function(){$("body").append('<div class="np-inline-overlay"></div>'),setTimeout((function(){$(".np-inline-overlay").addClass("active")}),50)},plugin.flashRow=function(row){$(row).addClass("np-updated"),plugin.setBorders(),setTimeout((function(){$(row).addClass("np-updated-show")}),1500)},plugin.showAjaxError=function(message){$(NestedPages.selectors.ajaxError).find("p").text(message),$(NestedPages.selectors.ajaxError).show()},plugin.hideAjaxError=function(message){$(NestedPages.selectors.ajaxError).hide()},plugin.sizeLinkThumbnails=function(){var thumbnail=$(NestedPages.selectors.thumbnailContainer).not(NestedPages.selectors.thumbnailContainerLink).first().find("img"),width=$(thumbnail).width(),height=$(thumbnail).height();$.each($(NestedPages.selectors.thumbnailContainerLink),(function(){$(this).width(width),$(this).height(height)}))}},(NestedPages=NestedPages||{}).Dropdowns=function(){var self=this,$=jQuery;return self.dropdown="",self.activeBtn="",self.activeContent="",self.toggleBtn="[data-dropdown-toggle]",self.dropdownContainer="[data-dropdown]",self.dropdownContent="[data-dropdown-content]",self.selectors={caret_up:"icon-arrow_drop_up",caret_down:"icon-arrow_drop_down"},self.bindEvents=function(){$(document).on("click",self.toggleBtn,(function(e){e.preventDefault(),self.activeBtn=$(this),self.dropdown=$(this).parents(self.dropdownContainer),self.toggleDropdown()})),$(document).on("click",(function(e){self.closeDropdowns(e.target)})),$(document).on("dropdown-opened",(function(e,content){$(content).parents(NestedPages.selectors.row).length>0&&$(content).parents(NestedPages.selectors.row).addClass("active")})),$(document).on("dropdown-closed",(function(){$(NestedPages.selectors.row).removeClass("active")}))},self.toggleDropdown=function(){$("."+self.selectors.caret_up).attr("class",self.selectors.caret_down);var content=$(self.dropdown).find(self.dropdownContent);if(self.activeContent=content,$(content).hasClass("active"))return $(content).removeClass("active"),$(self.activeBtn).removeClass("active"),$(self.activeBtn).find("."+self.selectors.caret_up).attr("class",self.selectors.caret_down),void $(document).trigger("dropdown-closed",content);self.setPositioning(),$(self.toggleBtn).removeClass("active"),$(self.dropdownContent).removeClass("active"),$(content).addClass("active"),$(self.activeBtn).find("."+self.selectors.caret_down).attr("class",self.selectors.caret_up),$(self.activeBtn).addClass("active"),$(document).trigger("dropdown-opened",content)},self.setPositioning=function(){var buttonHeight=$(self.activeBtn).outerHeight();$(self.activeContent).css("top",buttonHeight+"px")},self.closeDropdowns=function(target){var content;0===$(target).parents(self.dropdownContainer).length&&($(self.dropdownContent).removeClass("active"),$(self.toggleBtn).removeClass("active"),$(self.activeBtn).find("."+self.selectors.caret_up).attr("class",self.selectors.caret_down),$(document).trigger("dropdown-closed",void 0))},self.bindEvents()},(NestedPages=NestedPages||{}).Modals=function(){var self=this,$=jQuery;return self.activeBtn="",self.activeModal="",self.modalOpen=!1,self.selectors={toggleBtn:"[data-nestedpages-modal-toggle]",backdrop:"[data-nestedpages-modal-backdrop]",closeBtn:"[data-nestedpages-modal-close]",title:"data-nestedpages-modal-title",content:"data-nestedpages-modal-content"},self.bindEvents=function(){$(document).on("click",self.selectors.toggleBtn,(function(e){e.preventDefault(),self.activeBtn=$(this),self.openModal()})),$(document).on("click",self.selectors.closeBtn,(function(e){e.preventDefault(),self.closeModals()})),$(document).on("open-modal-manual",(function(e,modal){self.activeModal=$('[data-nestedpages-modal="'+modal+'"]'),self.openModal()})),$(document).on("close-modal-manual",(function(e){self.closeModals()})),$(document).on("click",self.selectors.backdrop,(function(e){self.closeModals()})),$(document).ready((function(){self.checkHash()}))},self.openModal=function(){if(self.modalOpen)self.closeModals();else{if($(self.activeBtn).length>0){var modal=$(self.activeBtn).attr("data-nestedpages-modal-toggle");self.activeModal=$('*[data-nestedpages-modal="'+modal+'"]')}$(self.activeModal).addClass("active"),self.modalOpen=!0,self.populateModal(),$(document).trigger("open-modal",[self.activeBtn,self.activeModal])}},self.closeModals=function(){self.modalOpen=!1,$("[data-nestedpages-modal]").removeClass("active"),self.activeModal="",self.activeBtn=""},self.populateModal=function(){var title=$(self.activeBtn).attr(self.selectors.title);void 0!==title&&""!==title&&$(self.activeModal).find("[data-nestedpages-modal-title]").text(title);var content=$(self.activeBtn).attr(self.selectors.content);void 0!==content&&""!==content&&$(self.activeModal).find("[data-nestedpages-modal-content]").html(content)},self.checkHash=function(){var hashType;if(window.location.hash&&"#modal"===window.location.hash.substring(0,6)){var modalId=window.location.hash.substring(7);self.activeModal=$('*[data-nestedpages-modal="'+modalId+'"]'),self.openModal()}},self.bindEvents()},(NestedPages=NestedPages||{}).CheckAll=function(){var plugin=this,$=jQuery;return plugin.activeCheckbox="",plugin.selectors={checkbox:"[data-np-check-all]"},plugin.bindEvents=function(){$(document).on("change",plugin.selectors.checkbox,(function(){plugin.activeCheckbox=$(this),plugin.toggleCheckboxes()})),$(document).on("change","input[type=checkbox]",(function(){plugin.checkAllStatus($(this))}))},plugin.init=function(){plugin.bindEvents()},plugin.toggleCheckboxes=function(){var checked=!!$(plugin.activeCheckbox).is(":checked"),name=$(plugin.activeCheckbox).attr("data-np-check-all"),checkboxes=$('*[name="'+name+'"]');$.each(checkboxes,(function(){var row=$(this).parents(NestedPages.selectors.rows);$(this).prop("checked",checked),$(row).hasClass("np-hide")&&!$(row).is(":visible")&&$(row).find(NestedPages.selectors.bulkActionsCheckbox).prop("checked",!1)})),plugin.toggleCheckAll()},plugin.toggleCheckAll=function(){var name=$(plugin.activeCheckbox).attr("data-np-check-all"),checkboxes_total=$('*[name="'+name+'"]').length,hidden_checkboxes,hidden_checkboxes_visible;checkboxes_total=checkboxes_total-$(".np-hide").find(NestedPages.selectors.bulkActionsCheckbox).length+$(".np-hide:visible").find(NestedPages.selectors.bulkActionsCheckbox).length;var checkboxes_checked=$('*[name="'+name+'"]:checked').length;if(checkboxes_total==checkboxes_checked)return $(plugin.activeCheckbox).prop("checked",!0),void $(plugin.activeCheckbox).removeClass("check-all-partial");checkboxes_checked>0?$(plugin.activeCheckbox).addClass("check-all-partial"):($(plugin.activeCheckbox).attr("checked",!1),$(plugin.activeCheckbox).removeClass("check-all-partial"))},plugin.checkAllStatus=function(checkbox){var name=$(checkbox).attr("name"),toggleAllCheckbox=$('*[data-np-check-all="'+name+'"]');0!==toggleAllCheckbox.length&&(plugin.activeCheckbox=$(toggleAllCheckbox)[0],plugin.toggleCheckAll())},plugin.init()},(NestedPages=NestedPages||{}).BulkActions=function(){var plugin=this,$=jQuery;return plugin.selectedNumber=0,plugin.selectedLinks=[],plugin.selectedPosts=[],plugin.init=function(){plugin.bindEvents()},plugin.bindEvents=function(){$(document).on("change",NestedPages.selectors.bulkActionsCheckbox,(function(){plugin.toggleBulkForm()})),$(document).on("submit",NestedPages.selectors.bulkActionsForm,(function(e){"edit"===$("select[name=np_bulk_action]").val()&&(e.preventDefault(),plugin.toggleBulkEdit(!0))})),$(document).on("click",NestedPages.selectors.bulkEditRemoveItem,(function(e){e.preventDefault();var id=$(this).siblings("input[type=hidden]").val();plugin.uncheckBulkItem(id)})),$(document).on("click",NestedPages.selectors.bulkEditCancel,(function(e){e.preventDefault(),plugin.uncheckAllBulkItems()}))},plugin.toggleBulkForm=function(){var checked=!1,checked_ids="",checked_redirect_ids="";if(plugin.selectedPosts=[],plugin.selectedLinks=[],$.each($(NestedPages.selectors.bulkActionsCheckbox),(function(){if($(this).is(":checked")){var row=$(this).parents(NestedPages.selectors.rows);if(checked=!0,$(this).parent("div").hasClass("np-check-all")||$(row).hasClass("post-type-np-redirect")||(checked_ids+=$(this).val()+","),$(row).hasClass("post-type-np-redirect")&&(checked_redirect_ids+=$(this).val()+",",plugin.selectedLinks.push($(this).val())),"np-redirect"!==$(this).attr("data-np-post-type")&&!$(this).parent("div").hasClass("np-check-all")){var post=[];post.title=$(this).attr("data-np-bulk-checkbox"),post.id=$(this).val(),plugin.selectedPosts.push(post)}}})),plugin.setBulkEditPosts(),plugin.toggleEditOption(),plugin.toggleLinkCountAlert(),checked)return $(NestedPages.selectors.bulkActionsForm).show(),$(NestedPages.selectors.bulkActionsIds).val(checked_ids),$(NestedPages.selectors.bulkActionRedirectIds).val(checked_redirect_ids),void plugin.setSelectedNumber();$(NestedPages.selectors.bulkActionsIds).val(""),$(NestedPages.selectors.bulkActionsForm).hide()},plugin.setBulkEditPosts=function(){for(var html="",i=0;i<plugin.selectedPosts.length;i++)html+='<li><a href="#" class="np-remove" data-np-remove-bulk-item>&times;</a>',html+=plugin.selectedPosts[i].title,html+='<input type="hidden" name="post_ids[]" value="'+plugin.selectedPosts[i].id+'"></li>';$(NestedPages.selectors.bulkEditTitles).html(html)},plugin.uncheckBulkItem=function(id){$.each($(NestedPages.selectors.bulkActionsCheckbox),(function(){$(this).val()==id&&$(this).prop("checked",!1).change()})),0===$(NestedPages.selectors.bulkEditRemoveItem).length&&plugin.toggleBulkEdit(!1)},plugin.uncheckAllBulkItems=function(){$.each($(NestedPages.selectors.bulkActionsCheckbox),(function(){$(this).prop("checked",!1).change()})),plugin.toggleBulkEdit(!1)},plugin.setSelectedNumber=function(){var checkedLength=$(NestedPages.selectors.bulkActionsCheckbox+":checked").not(".np-check-all input").length,option=$(NestedPages.selectors.bulkActionsForm).find("select option").first();$(option).text(nestedpages.bulk_actions+" ("+checkedLength+")")},plugin.toggleEditOption=function(){var checkedLength=$(NestedPages.selectors.bulkActionsCheckbox+":checked").not(".np-check-all input").not(".np-redirect-bulk").length,option=$(NestedPages.selectors.bulkActionsForm).find("select option[value=edit]");if(0===checkedLength)return $(option).prop("disabled",!0),$(NestedPages.selectors.bulkActionsForm).find("select option").first().prop("selected",!0),void plugin.toggleBulkEdit(!1);$(option).prop("disabled",!1)},plugin.toggleBulkEdit=function(visible){if(plugin.toggleLinkCountAlert(),visible)return plugin.disableParentOptions(),$(NestedPages.selectors.bulkEditForm).show(),$(NestedPages.selectors.bulkActionsForm).hide(),void plugin.setWPSuggest();$(NestedPages.selectors.bulkEditForm).hide(),$(NestedPages.selectors.bulkActionsForm).show(),$(NestedPages.selectors.bulkEditLinkCount).parent("div").hide(),$(NestedPages.selectors.bulkActionsForm).find("select option").first().text(nestedpages.bulk_actions),plugin.resetBulkEditFields()},plugin.toggleLinkCountAlert=function(){var selectedLinkCount;0!==plugin.selectedLinks.length?$(NestedPages.selectors.bulkEditLinkCount).parent("div").show():$(NestedPages.selectors.bulkEditLinkCount).parent("div").hide()},plugin.disableParentOptions=function(){for(var selectElement=$(NestedPages.selectors.bulkEditForm).find("select[name=post_parent]"),i=0;i<plugin.selectedPosts.length;i++)$(selectElement).find("option[value="+plugin.selectedPosts[i].id+"]").attr("disabled",!0)},plugin.setWPSuggest=function(){var tagfields=$(NestedPages.selectors.bulkEditForm).find("[data-autotag]");$.each(tagfields,(function(i,v){var taxonomy=$(this).attr("data-taxonomy");$(this).suggest(ajaxurl+"?action=ajax-tag-search&tax="+taxonomy,{multiple:!0,multipleSep:","})}))},plugin.resetBulkEditFields=function(){var selectFields=$(NestedPages.selectors.bulkEditForm).find("select");$.each(selectFields,(function(){$(this).find("option").first().prop("selected",!0),$(this).find("option").removeAttr("disabled")}));var categoryChecklists=$(NestedPages.selectors.bulkEditForm).find(".cat-checklist");$.each(categoryChecklists,(function(){$(this).find("input[type=checkbox]").prop("checked",!1)}))},plugin.init()},(NestedPages=NestedPages||{}).HiddenItemCount=function(){var plugin=this,$=jQuery;return plugin.init=function(){plugin.bindEvents()},plugin.bindEvents=function(){$(document).on("change",NestedPages.selectors.bulkActionsCheckbox,(function(){plugin.toggleHiddenCount()})),$(document).on("click",NestedPages.selectors.toggleAll,(function(){plugin.toggleHiddenCount()})),$(document).on("click",NestedPages.selectors.pageToggle,(function(){plugin.toggleHiddenCount()}))},plugin.toggleHiddenCount=function(){var hiddenCount=0;$.each($(NestedPages.selectors.bulkActionsCheckbox),(function(){if($(this).is(":checked")){if($(this).parent("div").hasClass("np-check-all"))return;var row=$(this).closest(".page-row");$(row).is(":visible")||hiddenCount++}})),hiddenCount<1?$(NestedPages.selectors.hiddenItemCountParent).hide():($(NestedPages.selectors.hiddenItemCount).text(hiddenCount),$(NestedPages.selectors.hiddenItemCountParent).show())},plugin.init()},(NestedPages=NestedPages||{}).MenuToggle=function(){var plugin=this,$=jQuery;return plugin.formatter=new NestedPages.Formatter,plugin.bindEvents=function(){$(document).on("click",NestedPages.selectors.childToggleLink,(function(e){e.preventDefault(),plugin.toggleSingleMenu($(this))})),$(document).on("click",NestedPages.selectors.toggleAll,(function(e){e.preventDefault(),plugin.toggleAllMenus()}))},plugin.toggleSingleMenu=function(button){var submenu=$(button).parent(NestedPages.selectors.childToggle).parent(NestedPages.selectors.row).siblings("ol");$(button).toggleClass("open"),$(submenu).toggle(),plugin.formatter.setBorders(),plugin.formatter.setNestedMargins(),plugin.syncUserToggles()},plugin.toggleAllMenus=function(){var button=NestedPages.selectors.toggleAll;if("closed"===$(button).attr("data-toggle"))return $(NestedPages.selectors.lists).show(),$(button).attr("data-toggle","opened").text(NestedPages.jsData.collapseText),$(NestedPages.selectors.childToggle+" a").addClass("open"),plugin.formatter.setBorders(),void plugin.syncUserToggles();$(NestedPages.selectors.lists).not($(NestedPages.selectors.lists)[0]).hide(),$(button).attr("data-toggle","closed").text(NestedPages.jsData.expandText),$(NestedPages.selectors.childToggle+" a").removeClass("open"),plugin.formatter.setBorders(),plugin.syncUserToggles()},plugin.visibleRowIDs=function(){var visible_ids=[],visible=$(NestedPages.selectors.rows+":visible");return $.each(visible,(function(i,v){var id=$(this).attr("id");visible_ids.push(id.replace("menuItem_",""))})),visible_ids},plugin.syncUserToggles=function(){$.ajax({url:NestedPages.jsData.ajaxurl,type:"post",datatype:"json",data:{action:NestedPages.formActions.syncToggles,nonce:NestedPages.jsData.nonce,ids:plugin.visibleRowIDs(),posttype:NestedPages.jsData.posttype},success:function(data){"success"!==data.status&&console.log("There was an error saving toggled pages.")}})},plugin.bindEvents()},(NestedPages=NestedPages||{}).PageToggle=function(){var plugin=this,$=jQuery;return plugin.activeButton="",plugin.formatter=new NestedPages.Formatter,plugin.init=function(){plugin.bindEvents()},plugin.bindEvents=function(){$(document).on("click",NestedPages.selectors.toggleHidden,(function(e){e.preventDefault(),plugin.activeButton=$(this),plugin.toggleHidden()})),$(document).on("click",NestedPages.selectors.toggleStatus,(function(e){e.preventDefault(),plugin.toggleStatus($(this))}))},plugin.toggleHidden=function(){var button=$(plugin.activeButton),action=$(button).attr("href");if("#show"==action)return $(button).attr("href","#hide").text(NestedPages.jsData.showHiddenText),$(NestedPages.selectors.hiddenRows).removeClass("shown").hide(),plugin.formatter.updateSubMenuToggle(),void plugin.formatter.setBorders();"#hide"==action&&($(button).attr("href","#show").text(NestedPages.jsData.hideHiddenText),$(NestedPages.selectors.hiddenRows).addClass("shown").show(),plugin.formatter.updateSubMenuToggle(),plugin.formatter.setBorders())},plugin.toggleStatus=function(button){var target=$(button).attr("href");target=target.substring(1),$(NestedPages.selectors.syncCheckbox).attr("disabled",!1),$(NestedPages.selectors.toggleStatus).removeClass("active"),$(button).addClass("active"),"draft"==target&&($(NestedPages.selectors.syncCheckbox).attr("disabled",!0),$("."+target).addClass("nested-visible")),"all"!=target?($(NestedPages.selectors.rows).hide(),$("."+target).show()):$(NestedPages.selectors.rows).show()},plugin.init()},(NestedPages=NestedPages||{}).Nesting=function(){var plugin=this,$=jQuery;plugin.formatter=new NestedPages.Formatter,plugin.initializeSortable=function(){if(!NestedPages.jsData.nestable)return plugin.initializeSortableFlat();$(NestedPages.selectors.sortable).not(NestedPages.selectors.notSortable).nestedSortable({items:NestedPages.selectors.rows,toleranceElement:"> .row",handle:NestedPages.selectors.handle,placeholder:"ui-sortable-placeholder",tabSize:56,isAllowed:function(placeholder,placeholderParent,currentItem){return!($(placeholderParent).hasClass("post-type-np-redirect")&&!$(currentItem).hasClass("post-type-np-redirect"))},start:function(e,ui){ui.placeholder.height(ui.item.height())},sort:function(e,ui){plugin.formatter.updatePlaceholderWidth(ui)},stop:function(e,ui){setTimeout((function(){plugin.formatter.updateSubMenuToggle(),plugin.formatter.setBorders(),plugin.formatter.setNestedMargins()}),100),plugin.syncNesting()}})},plugin.initializeSortableFlat=function(){var lists=$(NestedPages.selectors.lists).not(NestedPages.selectors.notSortable);$.each(lists,(function(){$(this).sortable({items:">"+NestedPages.selectors.rows,handle:NestedPages.selectors.handle,placeholder:"ui-sortable-placeholder",forcePlaceholderSize:!0,start:function(e,ui){ui.placeholder.height(ui.item.height())},sort:function(e,ui){plugin.formatter.updatePlaceholderWidth(ui)},stop:function(e,ui){setTimeout((function(){plugin.formatter.updateSubMenuToggle(),plugin.formatter.setBorders(),plugin.formatter.setNestedMargins()}),100),plugin.syncNesting()}})}))},plugin.disableNesting=function(){$(NestedPages.selectors.sortable).sortable("destroy")},plugin.syncNesting=function(manual,callback){var list,filtered;if("1"!==nestedpages.manual_order_sync||manual){$(NestedPages.selectors.errorDiv).hide(),$(NestedPages.selectors.loadingIndicator).show(),filtered=!!$(NestedPages.selectors.lists).first().hasClass("filtered"),list=NestedPages.jsData.nestable&&!filtered?$(NestedPages.selectors.sortable).nestedSortable("toHierarchy",{startDepthCount:0}):plugin.setNestingArray(),plugin.disableNesting();var syncmenu=NestedPages.jsData.syncmenu;"1"===nestedpages.manual_menu_sync&&(syncmenu="nosync"),$.ajax({url:ajaxurl,type:"post",datatype:"json",data:{action:NestedPages.formActions.syncNesting,nonce:NestedPages.jsData.nonce,list:list,post_type:NestedPages.jsData.posttype,syncmenu:syncmenu,filtered:filtered},success:function(data,callback){if(plugin.initializeSortable(),"error"===data.status)$(NestedPages.selectors.errorDiv).text(data.message).show(),$(NestedPages.selectors.loadingIndicator).hide();else{if(callback&&"function"==typeof callback)return void callback();$(NestedPages.selectors.loadingIndicator).hide()}}})}},plugin.setNestingArray=function(list){return ret=[],$(NestedPages.selectors.lists).first().children("li.page-row").each((function(){var level=plugin.recursiveNesting(this);ret.push(level)})),ret},plugin.recursiveNesting=function(item){var id=$(item).attr("id"),currentItem;if(id)return id=id.replace("menuItem_",""),currentItem={id:id},$(item).children(NestedPages.selectors.lists).children(NestedPages.selectors.rows).length>0&&(currentItem.children=[],$(item).children(NestedPages.selectors.lists).children(NestedPages.selectors.rows).each((function(){var level=plugin.recursiveNesting(this);currentItem.children.push(level)}))),currentItem}},(NestedPages=NestedPages||{}).SyncMenuSetting=function(){var plugin=this,$=jQuery;return plugin.formatter=new NestedPages.Formatter,plugin.init=function(){plugin.bindEvents()},plugin.bindEvents=function(){$(document).ready((function(){"1"!==nestedpages.manual_menu_sync&&"1"===nestedpages.syncmenu&&plugin.syncSetting()})),$(document).on("change",NestedPages.selectors.syncCheckbox,(function(){plugin.syncSetting()}))},plugin.syncSetting=function(){"page"===NestedPages.jsData.posttype&&0!==$(NestedPages.selectors.syncCheckbox).length&&(NestedPages.jsData.syncmenu=$(NestedPages.selectors.syncCheckbox).is(":checked")?"sync":"nosync",$.ajax({url:NestedPages.jsData.ajaxurl,type:"post",datatype:"json",data:{action:NestedPages.formActions.syncMenu,nonce:NestedPages.jsData.nonce,post_type:NestedPages.jsData.posttype,syncmenu:NestedPages.jsData.syncmenu},success:function(data){"error"===data.status&&plugin.formatter.showAjaxError(data.message)},error:function(data){console.log(data)}}))},plugin.bindEvents()},(NestedPages=NestedPages||{}).NewPost=function(){var plugin=this,$=jQuery;return plugin.formatter=new NestedPages.Formatter,plugin.parent_id=0,plugin.posts="",plugin.form="",plugin.bindEvents=function(){$(document).on("open-modal",(function(e,button,modal){var target=$(button).attr("data-nestedpages-modal-toggle");void 0!==target&&"np-bulk-modal"==target&&plugin.openModal()})),$(document).on("submit",NestedPages.selectors.newPageForm,(function(e){e.preventDefault()})),$(document).on("click",NestedPages.selectors.newPageSubmitButton,(function(e){e.preventDefault(),plugin.submitForm($(this))})),$(document).on("click",NestedPages.selectors.newPageTitle,(function(e){e.preventDefault(),plugin.addTitleField($(this))})),$(document).on("click",NestedPages.selectors.newPageRemoveTitle,(function(e){e.preventDefault(),plugin.removeTitleField($(this))})),$(document).on("click",NestedPages.selectors.addChildButton,(function(e){e.preventDefault(),plugin.openQuickEdit($(this))})),$(document).on("click",NestedPages.selectors.cancelNewChildButton,(function(e){e.preventDefault(),plugin.cancelNewPage()})),$(document).on("click","["+NestedPages.selectors.newBeforeButton+"]",(function(e){e.preventDefault(),plugin.openQuickEdit($(this))})),$(document).on("click","["+NestedPages.selectors.newAfterButton+"]",(function(e){e.preventDefault(),plugin.openQuickEdit($(this))})),$(document).on("keydown",(function(e){27===e.keyCode&&(plugin.cancelNewPage(),$(document).click())}))},plugin.openModal=function(){var newform=$(NestedPages.selectors.newPageFormContainer).clone().find(NestedPages.selectors.newPageForm);$(newform).addClass("in-modal"),$(NestedPages.selectors.newPageModal).find(".modal-body").html(newform),$(NestedPages.selectors.newPageModal).find("h3").text(nestedpages.add_multiple),$(NestedPages.selectors.newPageModal).find(".page_parent_id").val(plugin.parent_id),$(newform).find(".np_title").first().focus(),$(newform).find(NestedPages.selectors.newPageTitle).first().prop("tabindex","2")},plugin.openQuickEdit=function(button){var before=$(button).attr(NestedPages.selectors.newBeforeButton);before=void 0!==before&&""!==before&&before;var after=$(button).attr(NestedPages.selectors.newAfterButton);after=void 0!==after&&""!==after&&after;var parent_li=$(button).closest(NestedPages.selectors.row).parent("li"),newform=$(NestedPages.selectors.newPageFormContainer).clone();if($(parent_li).children("ol").length>0){var child_ol=$(parent_li).children("ol");$(newform).insertBefore(child_ol)}else $(newform).appendTo(parent_li);$(newform).siblings(NestedPages.selectors.row).hide(),plugin.formatter.showQuickEdit(),$(newform).find(".parent_name").html("<em>Parent:</em> "+$(button).attr("data-parentname")),before||after||$(newform).find(".page_parent_id").val($(button).attr("data-id")),before&&($(newform).find(".page_before_id").val(before),$(newform).find("[data-new-post-relation-title]").text(nestedpages.insert_before+": "+$(button).attr("data-parentname"))),after&&($(newform).find(".page_after_id").val(after),$(newform).find("[data-new-post-relation-title]").text(nestedpages.insert_after+": "+$(button).attr("data-parentname"))),$(newform).show(),$(newform).find(".np_title").focus(),$(newform).find(NestedPages.selectors.newPageTitle).prop("tabindex","2")},plugin.cancelNewPage=function(){plugin.formatter.removeQuickEdit(),$(NestedPages.selectors.newChildError).hide(),$(NestedPages.selectors.newPageModal).find(".modal-body").empty(),$(NestedPages.selectors.sortable).find(".new-child").remove(),$(NestedPages.selectors.row).show()},plugin.addTitleField=function(button){var form=$(button).parents("form"),fieldcount=$(button).siblings(".new-page-titles").children("li").length+1,html='<li><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="handle np-icon-menu"><path d="M0 0h24v24H0z" fill="none" /><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" class="bars" /></svg><div class="form-control new-child-row"><label>'+NestedPages.jsData.titleText+'</label><div><input type="text" name="post_title[]" class="np_title" placeholder="'+NestedPages.jsData.titleText+'" value="" tabindex="'+fieldcount+'" /><a href="#" class="button-secondary np-remove-child">-</a></div></div></li>',container=$(button).siblings(".new-page-titles").append(html);$(form).find(".np_title").last().focus(),$(form).find(NestedPages.selectors.newPageTitle).prop("tabindex",fieldcount++),$(".new-page-titles").sortable({items:"li",handle:".handle"}),plugin.toggleAddEditButton(form)},plugin.removeTitleField=function(button){var form=$(button).parents("form");$(button).parents(".new-child-row").parent("li").remove(),plugin.toggleAddEditButton(form)},plugin.submitForm=function(button){plugin.toggleLoading(!0),plugin.form=$(button).parents("form");var addedit=!!$(button).hasClass("add-edit"),action=NestedPages.formActions.newPage;""!==$(plugin.form).find(".page_before_id").val()&&(action=NestedPages.formActions.newBeforeAfter),""!==$(plugin.form).find(".page_after_id").val()&&(action=NestedPages.formActions.newBeforeAfter),$.ajax({url:NestedPages.jsData.ajaxurl,type:"post",datatype:"json",data:$(plugin.form).serialize()+"&action="+action+"&nonce="+NestedPages.jsData.nonce+"&syncmenu="+NestedPages.jsData.syncmenu+"&post_type="+NestedPages.jsData.posttype,success:function(data){if("error"===data.status)return plugin.toggleLoading(!1),void $(plugin.form).find(NestedPages.selectors.quickEditErrorDiv).text(data.message).show();if(!0===addedit){var link=data.new_pages[0].edit_link;return link=link.replace(/&amp;/g,"&"),void window.location.replace(link)}plugin.toggleLoading(!1),plugin.posts=data.new_pages,plugin.addPosts()},error:function(data){console.log(data),plugin.toggleLoading(!1),$(plugin.form).find(NestedPages.selectors.quickEditErrorDiv).text("The form could not be saved at this time.").show()}})},plugin.addPosts=function(){var before=$(plugin.form).find(".page_before_id").val();before=""!==before&&before;var after=$(plugin.form).find(".page_after_id").val();after=""!==after&&after;var parent_li=$(plugin.form).parent(".new-child").parent(".page-row");if(0!==$(parent_li).children("ol").length||before||after||$(parent_li).append('<ol class="nplist"></ol>'),$(plugin.form).hasClass("in-modal"))var appendto=$(".nplist.sortable li.page-row:first");else var appendto=$(parent_li).children("ol");for(i=0;i<plugin.posts.length;i++)plugin.appendRows(appendto,plugin.posts[i],before,after);before||after||$(appendto).show(),plugin.formatter.updateSubMenuToggle(),plugin.formatter.setNestedMargins(),plugin.cancelNewPage(),$(document).trigger("close-modal-manual")},plugin.appendRows=function(appendto,post,before,after){var html='<li id="menuItem_'+post.id+'" class="page-row';if("publish"===post.status&&(html+=" published"),html+='">',NestedPages.jsData.hierarchical?(html+='<div class="row">',html+='<div class="child-toggle"></div>'):(html+='<div class="row non-hierarchical">',html+='<div class="non-hierarchical-spacer"></div>'),html+='<div class="row-inner">',html+='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="np-icon-sub-menu"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M19 15l-6 6-1.42-1.42L15.17 16H4V4h2v10h9.17l-3.59-3.58L13 9l6 6z" class="arrow" /></svg>',html+='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="handle np-icon-menu"><path d="M0 0h24v24H0z" fill="none" /><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" class="bars" /></svg>',html+='<a href="'+post.edit_link+'" class="page-link page-title">',html+='<span class="title">'+post.title+"</span>","Publish"!==post.status?html+='<span class="status">('+post.status+")</span>":html+='<span class="status"></span>',html+='<span class="nav-status">',"hide"===post.np_nav_status&&(html+=" "+nestedpages.hidden),html+="</span>",html+='<span class="edit-indicator">Edit</span>',html+="</a>",NestedPages.jsData.hierarchical||(html+='<div class="np-post-columns">',html+='<ul class="np-post-info">',html+='<li><span class="np-author-display">'+post.author_formatted+"</span></li>",html+="<li>"+post.date_formatted+"</li>",html+="</ul>",html+="</div>"),$(".nplist").first().hasClass("has-yoast")&&(html+='<span class="np-seo-indicator na"></span>'),html+='<div class="action-buttons">',html+='<div class="nestedpages-dropdown" data-dropdown><a href="#" class="np-btn has-icon toggle" data-dropdown-toggle><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/></svg></a><ul class="nestedpages-dropdown-content" data-dropdown-content>',html+='<li><a href="#" class="open-redirect-modal" data-parentid="'+post.id+'"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/></svg>'+nestedpages.add_link+"</a></li>",html+='<li><a href="#" class="add-new-child" data-id="'+post.id+'" data-parentname="'+post.title+'"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M3 21h18v-2H3v2zM3 8v8l4-4-4-4zm8 9h10v-2H11v2zM3 3v2h18V3H3zm8 6h10V7H11v2zm0 4h10v-2H11v2z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'+nestedpages.add_child_short+"</a></li>",html+="</ul></div>",html+='<a href="#" class="np-btn np-quick-edit" data-id="'+post.id+'" data-template="'+post.page_template+'" data-category="'+post.post_category+'" data-title="'+post.title+'" data-slug="'+post.slug+'" data-commentstatus="closed" data-status="'+post.status.toLowerCase()+'" data-np-status="show"\tdata-navstatus="show" data-author="'+post.author+'" data-template="'+post.template+'" data-month="'+post.month+'" data-day="'+post.day+'" data-year="'+post.year+'" data-hour="'+post.hour+'" data-minute="'+post.minute+'" data-datepicker="'+post.datepicker+'" data-time="'+post.time+'" data-formattedtime="'+post.formattedtime+'" data-ampm="'+post.ampm+'">'+nestedpages.quick_edit+"</a>",html+='<a href="'+post.view_link+'" class="np-btn" target="_blank">'+nestedpages.view+"</a>",html+='<a href="'+post.delete_link+'" class="np-btn np-btn-trash"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="np-icon-remove"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" class="icon"/><path d="M0 0h24v24H0z" fill="none"/></svg></a>',html+="</div>\x3c!-- .action-buttons --\x3e",html+="</div>\x3c!-- .row-inner --\x3e</div>\x3c!-- .row --\x3e",html+="</li>",before){var row=plugin.findRowById(before);$(html).insertBefore(row)}else if(after){var row=plugin.findRowById(after);$(html).insertAfter(row)}else $(appendto).append(html)},plugin.findRowById=function(id){var row;return $(NestedPages.selectors.rows+"#menuItem_"+id)},plugin.toggleAddEditButton=function(form){var titleCount=$(form).find(".np_title").length;titleCount<1?$(NestedPages.selectors.newPageSubmitButton).hide():($(NestedPages.selectors.newPageSubmitButton).show(),titleCount>1?$(NestedPages.selectors.newPageSubmitButton+".add-edit").hide():$(NestedPages.selectors.newPageSubmitButton+".add-edit").show())},plugin.toggleLoading=function(loading){if(loading)return $(NestedPages.selectors.quickEditErrorDiv).hide(),$(NestedPages.selectors.newPageSubmitButton).attr("disabled","disabled"),void $(NestedPages.selectors.quickEditLoadingIndicator).show();$(NestedPages.selectors.newPageSubmitButton).attr("disabled",!1),$(NestedPages.selectors.quickEditLoadingIndicator).hide()},plugin.bindEvents()},(NestedPages=NestedPages||{}).QuickEditPost=function(){var plugin=this,$=jQuery;return plugin.formatter=new NestedPages.Formatter,plugin.button="",plugin.initialData="",plugin.parent_li="",plugin.form="",plugin.flatTerms="",plugin.termNames="",plugin.saveButton="",plugin.newData="",plugin.row="",plugin.bindEvents=function(){$(document).on("click",NestedPages.selectors.quickEditOpen,(function(e){e.preventDefault(),plugin.button=$(this),plugin.openForm()})),$(document).on("click",NestedPages.selectors.quickEditCancel,(function(e){e.preventDefault(),plugin.formatter.removeQuickEdit()})),$(document).on("change",".keep_private",(function(){this.checked?$(".post_password").val("").prop("readonly",!0):$(".post_password").prop("readonly",!1)})),$(document).on("click",NestedPages.selectors.quickEditSaveButton,(function(e){e.preventDefault(),plugin.saveButton=$(this),plugin.save()})),$(document).on("keydown",(function(e){27===e.keyCode&&plugin.formatter.removeQuickEdit()}))},plugin.openForm=function(){plugin.setInitialData(),plugin.createForm(),plugin.populateForm(),plugin.populateFlatTaxonomies()},plugin.setInitialData=function(){plugin.initialData={id:$(plugin.button).attr("data-id"),title:$(plugin.button).attr("data-title"),slug:$(plugin.button).attr("data-slug"),author:$(plugin.button).attr("data-author"),category:$(plugin.button).attr("data-post_category"),cs:$(plugin.button).attr("data-commentstatus"),status:$(plugin.button).attr("data-status"),template:$(plugin.button).attr("data-template"),month:$(plugin.button).attr("data-month"),day:$(plugin.button).attr("data-day"),year:$(plugin.button).attr("data-year"),hour:$(plugin.button).attr("data-hour"),minute:$(plugin.button).attr("data-minute"),navstatus:$(plugin.button).attr("data-navstatus"),npstatus:$(plugin.button).attr("data-np-status"),navtitle:$(plugin.button).attr("data-navtitle"),navtitleattr:$(plugin.button).attr("data-navtitleattr"),navcss:$(plugin.button).attr("data-navcss"),linktarget:$(plugin.button).attr("data-linktarget"),password:$(plugin.button).attr("data-password"),datepicker:$(plugin.button).attr("data-datepicker"),time:$(plugin.button).attr("data-formattedtime"),timeTwentyFour:$(plugin.button).attr("data-time"),ampm:$(plugin.button).attr("data-ampm"),timeFormat:$(plugin.button).attr("data-timeformat"),sticky:$(plugin.button).attr("data-sticky")};var attrs=$(plugin.button)[0].attributes;$.each(attrs,(function(i,attr){attr.name.includes("data-npcustom")&&(plugin.initialData[attr.name]=attr.value)})),plugin.initialData.h_taxonomies=[],plugin.initialData.f_taxonomies=[],plugin.parent_li=$(plugin.button).closest(NestedPages.selectors.row).parent("li");var classes=$(plugin.parent_li).attr("class").split(/\s+/);for(i=0;i<classes.length;i++)"in-"===classes[i].substring(0,3)&&plugin.initialData.h_taxonomies.push(classes[i]),"inf-"===classes[i].substring(0,4)&&plugin.initialData.f_taxonomies.push(classes[i])},plugin.createForm=function(){if(plugin.form=$(NestedPages.selectors.quickEditPostForm).clone(),$(plugin.parent_li).children("ol").length>0){var child_ol=$(plugin.parent_li).children("ol");$(plugin.form).insertBefore(child_ol)}else $(plugin.form).appendTo(plugin.parent_li);$(plugin.form).siblings(NestedPages.selectors.row).hide(),$(plugin.form).show()},plugin.populateForm=function(){for(var key in $(plugin.form).find(".page_id").html("<em>ID:</em> "+plugin.initialData.id),$(plugin.form).find(".np_id").val(plugin.initialData.id),$(plugin.form).find(".np_title").val(plugin.initialData.title),$(plugin.form).find(".np_slug").val(plugin.initialData.slug),$(plugin.form).find(".np_author select").val(plugin.initialData.author),$(plugin.form).find(".np_status").val(plugin.initialData.status),$(plugin.form).find(".np_nav_title").val(plugin.initialData.navtitle),$(plugin.form).find(".np_title_attribute").val(plugin.initialData.navtitleattr),$(plugin.form).find(".np_nav_css_classes").val(plugin.initialData.navcss),$(plugin.form).find(".post_password").val(plugin.initialData.password),$(plugin.form).find(".np_publish_date").val(plugin.initialData.datepicker),"open"===plugin.initialData.cs&&$(plugin.form).find(".np_cs").attr("checked","checked"),""!==plugin.initialData.template?$(plugin.form).find(".np_template").val(plugin.initialData.template):$(plugin.form).find(".np_template").val("default"),"private"===plugin.initialData.status&&($(plugin.form).find(".post_password").attr("readonly",!0),$(plugin.form).find(".keep_private").attr("checked",!0)),"hide"===plugin.initialData.npstatus?$(plugin.form).find(".nested_pages_status").attr("checked","checked"):$(plugin.form).find(".nested_pages_status").removeAttr("checked"),"hide"===plugin.initialData.navstatus?$(plugin.form).find(".np_nav_status").attr("checked","checked"):$(plugin.form).find(".np_nav_status").attr("checked",!1),"_blank"===plugin.initialData.linktarget?$(plugin.form).find(".link_target").attr("checked","checked"):$(plugin.form).find(".link_target").attr("checked",!1),"private"===plugin.initialData.status&&$(plugin.form).find(".np_status").val("publish"),"sticky"===plugin.initialData.sticky?$(plugin.form).find(".np-sticky").attr("checked","checked"):$(plugin.form).find(".np-sticky").removeAttr("checked"),"H:i"===plugin.initialData.timeFormat?$(plugin.form).find(".np_time").val(plugin.initialData.timeTwentyFour):($(plugin.form).find(".np_time").val(plugin.initialData.time),$(plugin.form).find(".np_ampm").val(plugin.initialData.ampm),$(plugin.form).find('select[name="mm"]').val(plugin.initialData.month),$(plugin.form).find('input[name="jj"]').val(plugin.initialData.day),$(plugin.form).find('input[name="aa"]').val(plugin.initialData.year),$(plugin.form).find('input[name="hh"]').val(plugin.initialData.hour),$(plugin.form).find('input[name="mn"]').val(plugin.initialData.minute)),plugin.initialData)if(key.includes("npcustom")&&plugin.initialData.hasOwnProperty(key)){var inputName=key.replace("data-npcustom-","");inputName=inputName.toLowerCase(),$(plugin.form).find('[data-np-custom-field="'+inputName+'"]').val(plugin.initialData[key])}if(plugin.populateFlatTaxonomies(),plugin.initialData.hasOwnProperty("h_taxonomies")){var taxonomies=plugin.initialData.h_taxonomies;for(i=0;i<taxonomies.length;i++){var tax="#"+taxonomies[i];$(plugin.form).find(tax).attr("checked","checked")}}var datepickers=$(plugin.form).find(".np_datepicker");$.each(datepickers,(function(){var $this=$(this);$this.datepicker({dateFormat:$this.attr("data-datepicker-format"),beforeShow:function(input,inst){$("#ui-datepicker-div").addClass("nestedpages-datepicker")}})})),plugin.formatter.showQuickEdit(),$(plugin.form).show()},plugin.populateFlatTaxonomies=function(){plugin.initialData.hasOwnProperty("f_taxonomies")&&(plugin.createTaxonomyObject(),plugin.getTermNames(),plugin.setWPSuggest())},plugin.createTaxonomyObject=function(){var out="",terms={};for(i=0;i<plugin.initialData.f_taxonomies.length;i++){var singleTerm=plugin.initialData.f_taxonomies[i],tax_array=singleTerm.split("-"),splitter=tax_array.indexOf("nps"),term=tax_array.splice(splitter+1);term=term.join("-");var tax=singleTerm.split("-").splice(0,splitter);tax.shift("inf");var taxonomy=tax.join("-"),term_array;taxonomy in terms||(terms[taxonomy]=[]),terms[taxonomy].push(term)}plugin.flatTerms=terms},plugin.getTermNames=function(){$.ajax({url:NestedPages.jsData.ajaxurl,type:"post",datatype:"json",data:{action:NestedPages.formActions.getTaxonomies,nonce:NestedPages.jsData.nonce,terms:plugin.flatTerms},success:function(data){plugin.termNames=data.terms,plugin.populateFlatTaxonomyFields()}})},plugin.populateFlatTaxonomyFields=function(){plugin.termNames&&$.each(plugin.termNames,(function(i,v){var textarea=$("#"+i+"-quickedit");$(textarea).val(v.join(","))}))},plugin.setWPSuggest=function(){var tagfields=$(plugin.form).find("[data-autotag]");$.each(tagfields,(function(i,v){var taxonomy=$(this).attr("data-taxonomy");$(this).suggest(ajaxurl+"?action=ajax-tag-search&tax="+taxonomy,{multiple:!0,multipleSep:","})}))},plugin.save=function(){plugin.toggleLoading(!0),$.ajax({url:NestedPages.jsData.ajaxurl,type:"post",datatype:"json",data:$(plugin.form).find("form").serialize()+"&action="+NestedPages.formActions.quickEditPost+"&nonce="+NestedPages.jsData.nonce+"&syncmenu="+NestedPages.jsData.syncmenu+"&post_type="+NestedPages.jsData.posttype,success:function(data){"error"===data.status?(plugin.toggleLoading(!1),$(plugin.form).find(NestedPages.selectors.quickEditErrorDiv).text(data.message).show()):(plugin.toggleLoading(!1),plugin.newData=data.post_data,plugin.updatePostRow())},error:function(data){console.log(data)}})},plugin.updatePostRow=function(){plugin.row=$(plugin.button).parents(".row-inner"),$(plugin.row).find(".title").text(plugin.newData.post_title),$(plugin.row).find(".np-view-button").attr("href",plugin.newData.permalink);var status=$(plugin.row).find(".status");if("publish"!==plugin.newData._status&&"future"!==plugin.newData._status){var newStatus=nestedpages.post_statuses[plugin.newData._status].label;$(status).text("("+newStatus+")")}else $(status).text("");if("private"===plugin.newData.keep_private&&$(status).text(nestedpages.private),""!==plugin.newData.post_password&&void 0!==plugin.newData.post_password){var statustext=$(status).text();statustext+=' <span class="locked">',statustext+='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/></svg>',statustext+="</span>",$(status).html(statustext)}var nav_status=$(plugin.row).find(".nav-status");"hide"==plugin.newData.nav_status?$(nav_status).text("(Hidden)"):$(nav_status).text("");var li=$(plugin.row).parent("li");"hide"==plugin.newData.np_status?($(li).addClass("np-hide"),$(plugin.row).find(".status").after('<svg class="row-status-icon status-np-hidden" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0zm0 0h24v24H0zm0 0h24v24H0zm0 0h24v24H0z" fill="none"/><path class="icon" d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/></svg>')):($(li).removeClass("np-hide"),$(plugin.row).find(".status-np-hidden").remove());var sticky=$(plugin.row).find(".sticky");"sticky"==plugin.newData.sticky?$(sticky).show():$(sticky).hide(),NestedPages.jsData.hierarchical||$(plugin.row).find(".np-author-display").text(plugin.newData.author_name);var button=$(plugin.row).find(NestedPages.selectors.quickEditOpen);for(var key in $(button).attr("data-id",plugin.newData.post_id),$(button).attr("data-category",plugin.newData.post_category),$(button).attr("data-template",plugin.newData.page_template),$(button).attr("data-title",plugin.newData.post_title),$(button).attr("data-slug",plugin.newData.post_name),$(button).attr("data-commentstatus",plugin.newData.comment_status),$(button).attr("data-status",plugin.newData._status),$(button).attr("data-sticky",plugin.newData.sticky),"private"===plugin.newData.keep_private&&$(button).attr("data-status","private"),$(button).attr("data-author",plugin.newData.post_author),$(button).attr("data-np-status",plugin.newData.np_status),$(button).attr("data-password",plugin.newData.post_password),$(button).attr("data-navstatus",plugin.newData.nav_status),$(button).attr("data-navtitle",plugin.newData.np_nav_title),$(button).attr("data-linktarget",plugin.newData.link_target),$(button).attr("data-navtitleattr",plugin.newData.np_title_attribute),$(button).attr("data-navcss",plugin.newData.np_nav_css_classes),$(button).attr("data-month",plugin.newData.mm),$(button).attr("data-day",plugin.newData.jj),$(button).attr("data-year",plugin.newData.aa),$(button).attr("data-hour",plugin.newData.hh),$(button).attr("data-minute",plugin.newData.mn),$(button).attr("data-datepicker",plugin.newData.np_date),$(button).attr("data-time",plugin.newData.np_time),$(button).attr("data-formattedtime",plugin.newData.np_time),$(button).attr("data-ampm",plugin.newData.np_ampm),plugin.newData)if(key.includes("np_custom")&&plugin.newData.hasOwnProperty(key)){var attrName=key.replace("np_custom_","data-npcustom-");$(button).attr(attrName,plugin.newData[key])}plugin.removeTaxonomyClasses(),plugin.addCategoryClasses(),plugin.addHierarchicalClasses(),plugin.addFlatClasses(),plugin.addStatusClass(),plugin.formatter.removeQuickEdit(),plugin.formatter.flashRow(plugin.row)},plugin.addStatusClass=function(){var statuses=["published","draft","pending","future"];for(i=0;i<statuses.length;i++)$(plugin.row).removeClass(statuses[i]);$(plugin.row).addClass(plugin.newData._status)},plugin.removeTaxonomyClasses=function(){taxonomies=[];var classes=$(plugin.row).attr("class").split(/\s+/);for(i=0;i<classes.length;i++)"in-"===classes[i].substring(0,3)&&$(plugin.row).removeClass(classes[i]),"inf-"===classes[i].substring(0,4)&&$(plugin.row).removeClass(classes[i])},plugin.addCategoryClasses=function(){if(plugin.newData.hasOwnProperty("post_category")){var cats=plugin.newData.post_category;for(i=0;i<cats.length;i++){var taxclass="in-category-"+cats[i];$(plugin.row).addClass(taxclass)}}},plugin.addHierarchicalClasses=function(){if(plugin.newData.hasOwnProperty("tax_input")){var taxonomies=plugin.newData.tax_input;$.each(taxonomies,(function(tax,terms){for(i=0;i<terms.length;i++){var taxclass="in-"+tax+"-"+terms[i];$(plugin.row).addClass(taxclass)}}))}},plugin.addFlatClasses=function(){if(plugin.newData.hasOwnProperty("flat_tax")){var taxonomies=plugin.newData.flat_tax;$.each(taxonomies,(function(tax,terms){for(i=0;i<terms.length;i++){var taxclass="inf-"+tax+"-nps-"+terms[i];$(plugin.row).addClass(taxclass)}}))}},plugin.toggleLoading=function(loading){if(loading)return $(NestedPages.selectors.quickEditErrorDiv).hide(),$(plugin.saveButton).attr("disabled","disabled"),void $(NestedPages.selectors.quickEditLoadingIndicator).show();$(plugin.saveButton).attr("disabled",!1),$(NestedPages.selectors.quickEditLoadingIndicator).hide()},plugin.bindEvents()},(NestedPages=NestedPages||{}).QuickEditLink=function(){var plugin=this,$=jQuery;return plugin.formatter=new NestedPages.Formatter,plugin.button="",plugin.postData="",plugin.newPostData="",plugin.form="",plugin.bindEvents=function(){$(document).on("click",NestedPages.selectors.quickEditButtonLink,(function(e){e.preventDefault(),plugin.formatter.removeQuickEdit(),plugin.button=$(this),plugin.openQuickEdit()})),$(document).on("click",NestedPages.selectors.quickEditLinkSaveButton,(function(e){e.preventDefault(),plugin.submitForm()})),$(document).on("keydown",(function(e){27===e.keyCode&&plugin.formatter.removeQuickEdit()}))},plugin.openQuickEdit=function(){plugin.setData(),plugin.createForm(),plugin.populateForm()},plugin.setData=function(){plugin.postData={id:$(plugin.button).attr("data-id"),url:$(plugin.button).attr("data-url"),title:$(plugin.button).attr("data-title"),status:$(plugin.button).attr("data-status"),navstatus:$(plugin.button).attr("data-navstatus"),npstatus:$(plugin.button).attr("data-np-status"),linktarget:$(plugin.button).attr("data-linktarget"),parentid:$(plugin.button).attr("data-parentid"),navtitleattr:$(plugin.button).attr("data-navtitleattr"),navcss:$(plugin.button).attr("data-navcss"),navtype:$(plugin.button).attr("data-nav-type"),navobject:$(plugin.button).attr("data-nav-object"),navobjectid:$(plugin.button).attr("data-nav-object-id"),navoriginallink:$(plugin.button).attr("data-nav-original-link"),navoriginaltitle:$(plugin.button).attr("data-nav-original-title")}},plugin.createForm=function(){var parent_li=$(plugin.button).closest(NestedPages.selectors.row).parent("li");if(plugin.form=$(NestedPages.selectors.quickEditLinkForm).clone(),$(parent_li).children("ol").length>0){var child_ol=$(parent_li).children("ol");$(plugin.form).insertBefore(child_ol)}else $(plugin.form).appendTo(parent_li);var row=$(plugin.form).siblings(NestedPages.selectors.row).hide()},plugin.populateForm=function(){if($(plugin.form).find(".np_id").val(plugin.postData.id),$(plugin.form).find(".np_title").val(plugin.postData.title),$(plugin.form).find(".np_author select").val(plugin.postData.author),$(plugin.form).find(".np_status").val(plugin.postData.status),$(plugin.form).find(".np_content").val(plugin.postData.url),$(plugin.form).find(".np_parent_id").val(plugin.postData.parentid),$(plugin.form).find(".np_title_attribute").val(plugin.postData.navtitleattr),$(plugin.form).find(".np_nav_css_classes").val(plugin.postData.navcss),"hide"===plugin.postData.npstatus?$(plugin.form).find(".np_status").prop("checked","checked"):$(plugin.form).find(".np_status").removeAttr("checked"),"hide"===plugin.postData.navstatus?$(plugin.form).find(".np_nav_status").prop("checked","checked"):$(plugin.form).find(".np_nav_status").removeAttr("checked"),"_blank"===plugin.postData.linktarget?$(plugin.form).find(".link_target").prop("checked","checked"):$(plugin.form).find(".link_target").removeAttr("checked"),"custom"!==plugin.postData.navobject&&""!==plugin.postData.navobject){var html='<div class="form-control original-link">Original: <a href="'+plugin.postData.navoriginallink+'" target="_blank">'+plugin.postData.navoriginaltitle+"</a></div>";$(plugin.form).find("[data-url-field]").remove(),$(html).insertAfter($(plugin.form).find("h3")),$(plugin.form).find("[data-np-menu-object-input]").val(plugin.postData.navobject),$(plugin.form).find("[data-np-menu-objectid-input]").val(plugin.postData.navobjectid),$(plugin.form).find("[data-np-menu-type-input]").val(plugin.postData.navtype),$(plugin.form).find("h3").text("Link: "+plugin.postData.navoriginaltitle)}else $(plugin.form).find("h3").text("Link"),$(plugin.form).find("[data-np-menu-object-input]").val("custom"),$(plugin.form).find("[data-np-menu-type-input]").val("custom");plugin.formatter.showQuickEdit(),$(plugin.form).show()},plugin.submitForm=function(){plugin.toggleLoading(!0),$.ajax({url:NestedPages.jsData.ajaxurl,type:"post",datatype:"json",data:$(plugin.form).find("form").serialize()+"&action="+NestedPages.formActions.quickEditLink+"&nonce="+NestedPages.jsData.nonce+"&syncmenu="+NestedPages.jsData.syncmenu+"&post_type="+NestedPages.jsData.posttype,success:function(data){"error"===data.status?(plugin.toggleLoading(!1),$(plugin.form).find(NestedPages.selectors.quickEditErrorDiv).text(data.message).show()):(plugin.toggleLoading(!1),plugin.newPostData=data.post_data,plugin.updateRow())},error:function(data){plugin.toggleLoading(!1),$(plugin.form).find(NestedPages.selectors.quickEditErrorDiv).text("The form could not be saved at this time.").show()}})},plugin.updateRow=function(){var row=$(plugin.form).siblings(".row");$(row).find(".title").html(plugin.newPostData.post_title+' <svg class="link-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path class="icon" d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/></svg>');var status=$(row).find(".status");"publish"!==plugin.newPostData._status&&"future"!==plugin.newPostData._status?$(status).text("("+plugin.newPostData._status+")"):$(status).text("");var nav_status=$(row).find(".nav-status");"hide"==plugin.newPostData.nav_status?$(nav_status).text("("+NestedPages.jsData.hiddenText+")"):$(nav_status).text("");var li=$(row).parent("li");"hide"==plugin.newPostData.np_status?($(li).addClass("np-hide"),$(row).find(".status").after('<svg class="row-status-icon status-np-hidden" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0zm0 0h24v24H0zm0 0h24v24H0zm0 0h24v24H0z" fill="none"/><path class="icon" d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/></svg>')):($(li).removeClass("np-hide"),$(row).find(".status-np-hidden").remove());var button=$(row).find(NestedPages.selectors.quickEditButtonLink);$(button).attr("data-id",plugin.newPostData.post_id),$(button).attr("data-title",plugin.newPostData.post_title),$(button).attr("data-url",plugin.newPostData.post_content),$(button).attr("data-status",plugin.newPostData._status),$(button).attr("data-navstatus",plugin.newPostData.nav_status),$(button).attr("data-np-status",plugin.newPostData.np_status),$(button).attr("data-linkTarget",plugin.newPostData.linkTarget),$(button).attr("data-navtitleattr",plugin.newPostData.titleAttribute),$(button).attr("data-navcss",plugin.newPostData.cssClasses),plugin.formatter.removeQuickEdit(),plugin.formatter.flashRow(row)},plugin.toggleLoading=function(loading){if($(".row").removeClass("np-updated").removeClass("np-updated-show"),loading)return $(NestedPages.selectors.quickEditErrorDiv).hide(),$(NestedPages.selectors.quickEditLinkSaveButton).attr("disabled","disabled"),void $(NestedPages.selectors.quickEditLoadingIndicator).show();$(NestedPages.selectors.quickEditLinkSaveButton).attr("disabled",!1),$(NestedPages.selectors.quickEditLoadingIndicator).hide()},plugin.bindEvents()},(NestedPages=NestedPages||{}).Clone=function(){var plugin=this,$=jQuery;return plugin.parent_id="",plugin.parent_title="",plugin.parentLi=null,plugin.formatter=new NestedPages.Formatter,plugin.bindEvents=function(){$(document).on("click",NestedPages.selectors.cloneButton,(function(e){e.preventDefault(),plugin.parent_id=$(this).attr("data-id"),plugin.parent_title=$(this).attr("data-parentname"),plugin.parentLi=$(this).parent(".row").parent(".page-row").parent(".npList"),plugin.openModal()})),$(document).on("click",NestedPages.selectors.confirmClone,(function(e){e.preventDefault(),plugin.clone()}))},plugin.openModal=function(){$("#"+NestedPages.selectors.cloneModal).find("[data-clone-parent]").text(plugin.parent_title),$(document).trigger("open-modal-manual",NestedPages.selectors.cloneModal)},plugin.clone=function(){plugin.toggleLoading(!0),$.ajax({url:NestedPages.jsData.ajaxurl,type:"post",data:{action:NestedPages.formActions.clonePost,parent_id:plugin.parent_id,quantity:$(NestedPages.selectors.cloneQuantity).val(),status:$(NestedPages.selectors.cloneStatus).val(),author:$(NestedPages.selectors.cloneAuthor).find("select").val(),nonce:NestedPages.jsData.nonce,posttype:NestedPages.jsData.posttype},success:function(data){plugin.toggleLoading(!1),$(document).trigger("close-modal-manual"),location.reload()}})},plugin.toggleLoading=function(loading){if(loading)return $("#"+NestedPages.selectors.cloneModal).find("[data-clone-loading]").show(),void $(NestedPages.selectors.confirmClone).attr("disabled","disabled");$("#"+NestedPages.selectors.cloneModal).find("[data-clone-loading]").hide(),$(NestedPages.selectors.confirmClone).attr("disabled",!1)},plugin.bindEvents()},(NestedPages=NestedPages||{}).Tabs=function(){var self=this,$=jQuery;return self.selectors={tabToggle:"data-np-tab-toggle",tabPane:"data-np-tab-pane",tabGroup:"data-np-tab-group"},self.bindEvents=function(){$(document).on("click","["+self.selectors.tabToggle+"]",(function(e){e.preventDefault(),self.toggleTabs($(this))}))},self.toggleTabs=function(tab){for(var tabGroup=$(tab).attr(self.selectors.tabGroup),tabPanes=$("*["+self.selectors.tabGroup+"="+tabGroup+"]["+self.selectors.tabPane+"]"),activeTab=$(tab).attr(self.selectors.tabToggle),buttons=$("*["+self.selectors.tabGroup+"="+tabGroup+"]["+self.selectors.tabToggle+"]"),listItems=[],i=0;i<buttons.length;i++)listItems[i]=$(buttons[i]).parent("li")[0];$(tabPanes).hide(),$(buttons).removeClass("active"),$(listItems).removeClass("active"),$.each(tabPanes,(function(){$(this).attr(self.selectors.tabPane)==activeTab&&$(this).show()})),$.each(buttons,(function(){$(this).attr(self.selectors.tabToggle)==activeTab&&($(this).addClass("active"),$(this).parent("li").addClass("active"))})),$(document).trigger("tabs-changed",[activeTab,tabGroup,tab])},self.bindEvents()},jQuery(document).ready((function(){new NestedPages.Factory})),(NestedPages=NestedPages||{}).selectors={childToggle:".child-toggle",childToggleLink:".child-toggle a",toggleAll:".nestedpages-toggleall",toggleHidden:".np-toggle-hidden",toggleStatus:".np-toggle-publish",lists:".nplist",rows:".page-row",row:".row",sortable:".sortable",notSortable:".no-sort",handle:".handle",published:".published",hiddenRows:".np-hide",errorDiv:"#np-error",loadingIndicator:"#nested-loading",syncCheckbox:".np-sync-menu",syncForm:".np-sync-menu-cont",ajaxError:"[data-nestedpages-error]",trashWithChildrenButton:"[data-nestedpages-trash-children]",toggleEditButtons:".np-toggle-edit",bulkActionsHeader:".nestedpages-list-header",bulkActionsForm:"[data-np-bulk-form]",bulkActionsCheckbox:"[data-np-bulk-checkbox]",bulkActionsIds:"[data-np-bulk-ids]",bulkActionRedirectIds:"[data-np-bulk-redirect-ids]",hiddenItemCount:"[data-np-hidden-count]",hiddenItemCountParent:"[data-np-hidden-count-parent]",bulkEditForm:"[data-np-bulk-edit-form]",bulkEditTitles:"[data-np-bulk-titles]",bulkEditRemoveItem:"[data-np-remove-bulk-item]",bulkEditCancel:"[data-np-cancel-bulk-edit]",bulkEditLinkCount:"[data-bulk-edit-link-count]",quickEditOverlay:".np-inline-overlay",quickEditLoadingIndicator:".np-qe-loading",quickEditErrorDiv:".np-quickedit-error",quickEditCancel:".np-cancel-quickedit",quickEditButtonLink:".np-quick-edit-redirect",quickEditLinkForm:".quick-edit-form-redirect",quickEditLinkSaveButton:".np-save-quickedit-redirect",quickEditOpen:".np-quick-edit",quickEditPostForm:".quick-edit-form",quickEditSaveButton:".np-save-quickedit",openLinkModal:".open-redirect-modal",linkModal:"np-link-modal",saveLink:".np-save-link",linkLoadingIndicator:".np-link-loading",linkErrorDiv:".np-new-link-error",linkForm:".np-new-link-form",linkDeleteButton:"[data-np-confirm-delete]",linkDeleteConfirmationButton:"[data-delete-confirmation]",linkDeleteConfirmationModal:"np-delete-confirmation-modal",linkDeleteConfirmationModalText:"[data-np-link-delete-text]",openPageModal:".open-bulk-modal",newPageModal:"#np-bulk-modal",newPageFormContainer:".new-child-form",newPageForm:".np-new-child-form",newPageSubmitButton:".np-save-newchild",newPageTitle:".add-new-child-row",newPageRemoveTitle:".np-remove-child",addChildButton:".add-new-child",newChildError:".np-newchild-error",cancelNewChildButton:".np-cancel-newchild",newBeforeButton:"data-insert-before",newAfterButton:"data-insert-after",cloneButton:".clone-post",confirmClone:"[data-confirm-clone]",cloneModal:"np-clone-modal",cloneQuantity:"[data-clone-quantity]",cloneStatus:"[data-clone-status]",cloneAuthor:"[data-clone-author]",tabButtonParent:"[data-np-tabs]",tabButton:"[data-np-tab]",tabContent:"[data-np-tab-pane]",thumbnailContainer:".np-thumbnail",thumbnailContainerLink:".np-thumbnail.link",manualMenuSync:"[data-np-manual-menu-sync]",manualOrderSync:"[data-np-manual-order-sync]"},NestedPages.cssClasses={noborder:"no-border"},NestedPages.jsData={ajaxurl:ajaxurl,nonce:nestedpages.np_nonce,allPostTypes:nestedpages.post_types,syncmenu:"nosync",posttype:"",nestable:!0,sortable:!0,hierarchical:!0,expandText:nestedpages.expand_text,collapseText:nestedpages.collapse_text,showHiddenText:nestedpages.show_hidden,hideHiddenText:nestedpages.hide_hidden,quickEditText:nestedpages.quick_edit,hiddenText:nestedpages.hidden,titleText:nestedpages.title},NestedPages.formActions={syncToggles:"npnestToggle",syncNesting:"npsort",syncMenu:"npsyncMenu",newPage:"npnewChild",newBeforeAfter:"npnewBeforeAfter",quickEditLink:"npquickEditLink",getTaxonomies:"npgetTaxonomies",quickEditPost:"npquickEdit",clonePost:"npclonePost",search:"npmenuSearch",newMenuItem:"npnewMenuItem",manualMenuSync:"npmanualMenuSync",postSearch:"nppostSearch",wpmlTranslations:"npWpmlTranslations",resetSettings:"npresetSettings",resetUserPrefs:"npresetUserPreferences",resetAdminMenuSettings:"npresetAdminMenuSettings",trashWithChildren:"nptrashWithChildren"},NestedPages.Factory=function(){var plugin=this,$=jQuery;return plugin.formatter=new NestedPages.Formatter,plugin.dropdowns=new NestedPages.Dropdowns,plugin.modals=new NestedPages.Modals,plugin.checkAll=new NestedPages.CheckAll,plugin.bulkActions=new NestedPages.BulkActions,plugin.menuToggle=new NestedPages.MenuToggle,plugin.pageToggle=new NestedPages.PageToggle,plugin.nesting=new NestedPages.Nesting,plugin.syncMenuSetting=new NestedPages.SyncMenuSetting,plugin.newPage=new NestedPages.NewPost,plugin.quickEditLink=new NestedPages.QuickEditLink,plugin.quickEditPost=new NestedPages.QuickEditPost,plugin.clone=new NestedPages.Clone,plugin.tabs=new NestedPages.Tabs,plugin.menuLinks=new NestedPages.MenuLinks,plugin.hiddenItemCount=new NestedPages.HiddenItemCount,plugin.confirmDelete=new NestedPages.ConfirmDelete,plugin.manualSync=new NestedPages.ManualSync,plugin.postSearch=new NestedPages.PostSearch,plugin.postMove=new NestedPages.MovePost,plugin.wpml=new NestedPages.Wpml,plugin.trashWithChildren=new NestedPages.TrashWithChildren,plugin.init=function(){nestedpages.settings_page||(plugin.bindEvents(),plugin.setPostType(),plugin.setMenuSync(),plugin.setNestable(),plugin.setSortable(),plugin.formatter.updateSubMenuToggle(),plugin.formatter.setBorders(),plugin.formatter.setNestedMargins(),plugin.nesting.initializeSortable())},plugin.bindEvents=function(){$(document).on("click",NestedPages.selectors.quickEditOverlay,(function(e){plugin.formatter.removeQuickEdit(),plugin.newPage.cancelNewPage()})),$(document).ready((function(){plugin.formatter.hideAjaxError(),plugin.formatter.sizeLinkThumbnails()}))},plugin.setNestable=function(){var nestable=!1;$.each(NestedPages.jsData.allPostTypes,(function(i,v){v.name===NestedPages.jsData.posttype&&(!0===v.hierarchical&&(nestable=!0),!0===v.disable_nesting&&(nestable=!1))})),NestedPages.jsData.nestable=nestable},plugin.setSortable=function(){var sortable=!0;$.each(NestedPages.jsData.allPostTypes,(function(i,v){v.name===NestedPages.jsData.posttype&&void 0!==v.disable_sorting&&""!==v.disable_sorting&&"true"===v.disable_sorting&&(sortable=!1)})),NestedPages.jsData.sortable=sortable},plugin.setPostType=function(){NestedPages.jsData.posttype=nestedpages.current_post_type,void 0!==NestedPages.jsData.posttype&&""!==NestedPages.jsData.posttype||(NestedPages.jsData.posttype=$(NestedPages.selectors.sortable).attr("id").substring(3)),NestedPages.jsData.hierarchical=NestedPages.jsData.allPostTypes[NestedPages.jsData.posttype].hierarchical},plugin.setMenuSync=function(){NestedPages.jsData.syncmenu="1"===nestedpages.syncmenu?"sync":"nosync"},plugin.init()},(NestedPages=NestedPages||{}).MenuLinks=function(){var plugin=this,$=jQuery;return plugin.typeButton="",plugin.post="",plugin.formatter=new NestedPages.Formatter,plugin.selectors={form:"[data-np-menu-item-form]",typeSelect:"[data-np-menu-selection]",accordion:"[data-np-menu-accordion]",accordionItem:"[data-np-menu-accordion-item]",formPlaceholder:".np-menu-link-object-placeholder",formDetails:".np-menu-link-details",searchResults:"[data-np-search-result]",defaultResults:"[data-default-result]",originalLink:"[data-np-original-link]",saveButton:"[data-np-save-link]",urlInputCont:"[data-np-menu-url-cont]",errorDiv:"[data-np-error]"},plugin.fields={object:"[data-np-menu-object-input]",objectid:"[data-np-menu-objectid-input]",itemType:"[data-np-menu-type-input]",url:"[data-np-menu-url]",navigationLabel:"[data-np-menu-navigation-label]",titleAttribute:"[data-np-menu-title-attr]",cssClasses:"[data-np-menu-css-classes]",npStatus:"[data-np-menu-np-status]",linkTarget:"[data-np-menu-link-target]",menuTitle:"[data-np-menu-title]",parentPostType:"[data-np-menu-parent-post-type]"},plugin.search=new NestedPages.MenuSearch,plugin.bindEvents=function(){$(document).on("click",NestedPages.selectors.openLinkModal,(function(e){e.preventDefault(),plugin.postParent=$(this).attr("data-parentid"),$(plugin.selectors.form).find(".parent_id").val($(this).attr("data-parentid")),plugin.openModal()})),$(document).on("click",plugin.selectors.accordionItem,(function(e){e.preventDefault(),plugin.accordion($(this))})),$(document).on("click",plugin.selectors.typeSelect,(function(e){e.preventDefault(),plugin.typeButton=$(this),plugin.setLinkType()})),$(document).on("keyup",plugin.fields.navigationLabel,(function(){plugin.updateTitle()})),$(document).on("click",plugin.selectors.saveButton,(function(e){e.preventDefault(),plugin.submitForm()})),$(document).on("keydown",(function(e){27===e.keyCode&&$(document).trigger("close-modal-manual")}))},plugin.openModal=function(){$(NestedPages.selectors.linkErrorDiv).hide(),$(NestedPages.selectors.linkModal).find("input").val(""),$(NestedPages.selectors.linkModal).find(".parent_id").val(plugin.postParent),plugin.clearForm(),$(plugin.selectors.accordion).find("ul").hide(),$(plugin.selectors.typeSelect).removeClass("active"),$(document).trigger("open-modal-manual",NestedPages.selectors.linkModal)},plugin.accordion=function(button){plugin.clearForm();var submenu=$(button).siblings("ul");if($(submenu).is(":visible"))return $(button).removeClass("active"),void $(submenu).slideUp("fast");$(plugin.selectors.accordionItem).removeClass("active"),$(button).addClass("active"),$(button).parents(plugin.selectors.accordion).find("ul").slideUp("fast"),$(submenu).slideDown("fast")},plugin.setLinkType=function(){$(plugin.typeButton).hasClass("active")?plugin.clearForm():($(plugin.typeButton).hasClass("np-custom-link")&&($(plugin.selectors.accordionItem).removeClass("active"),$(plugin.selectors.accordion).find("ul").slideUp("fast")),$(plugin.selectors.formPlaceholder).hide(),plugin.populateForm())},plugin.populateForm=function(){$(plugin.selectors.saveButton).show(),$(plugin.selectors.typeSelect).removeClass("active"),$(plugin.typeButton).addClass("active"),$(plugin.fields.menuTitle).text($(plugin.typeButton).text()).val($(plugin.typeButton).text()),$(plugin.selectors.form).find("h3").find("em").text($(plugin.typeButton).attr("data-np-object-name")),""!==$(plugin.typeButton).attr("data-np-permalink")?($(plugin.selectors.form).find(plugin.selectors.urlInputCont).hide(),$(plugin.selectors.form).find(plugin.selectors.originalLink).html('<a href="'+$(plugin.typeButton).attr("data-np-permalink")+'">'+$(plugin.typeButton).text()+"</a>"),$(plugin.selectors.form).find(plugin.selectors.originalLink).parent(".original-link").show()):($(plugin.selectors.form).find(plugin.selectors.urlInputCont).show(),$(plugin.selectors.form).find(plugin.selectors.originalLink).parent(".original-link").hide()),$(plugin.fields.object).val($(plugin.typeButton).attr("data-np-menu-object")),$(plugin.fields.objectid).val($(plugin.typeButton).attr("data-np-menu-objectid")),$(plugin.fields.itemType).val($(plugin.typeButton).attr("data-np-menu-type")),$(plugin.selectors.formDetails).show()},plugin.clearForm=function(){$(plugin.selectors.form).find(plugin.selectors.errorDiv).hide(),$(plugin.selectors.saveButton).hide(),$(plugin.selectors.formDetails).hide(),$(plugin.selectors.formPlaceholder).show(),$(plugin.selectors.form).find("input").not(".parent_id").not(".parent-post-type").val(""),$(plugin.selectors.form).find(plugin.fields.linkTarget).val("_blank"),$(plugin.selectors.form).find('input[type="checkbox"]').attr("checked",!1),$(plugin.selectors.typeSelect).removeClass("active"),plugin.search.toggleLoading(!1),$(plugin.selectors.searchResults).remove(),$(plugin.selectors.defaultResults).show()},plugin.updateTitle=function(){var value=$(plugin.fields.navigationLabel).val(),title=$(plugin.selectors.form).find("h3").find("span");""!==value?($(plugin.fields.menuTitle).val(value),$(title).text(value)):($(plugin.fields.menuTitle).val($(plugin.typeButton).text()),$(title).text($(plugin.typeButton).text()))},plugin.submitForm=function(){plugin.toggleLoading(!0),$.ajax({url:NestedPages.jsData.ajaxurl,type:"post",data:$(plugin.selectors.form).serialize()+"&action="+NestedPages.formActions.newMenuItem+"&nonce="+NestedPages.jsData.nonce+"&post_type="+NestedPages.jsData.posttype+"&syncmenu="+NestedPages.jsData.syncmenu,success:function(data){plugin.toggleLoading(!1),"error"!==data.status?(plugin.post=data.post_data,plugin.createRow()):$(plugin.selectors.form).find(plugin.selectors.errorDiv).text(data.message).show()},error:function(data){console.log(data)}})},plugin.createRow=function(){var html='<li id="menuItem_'+plugin.post.id+'" class="page-row published';html+='">',html+='<div class="row"><div class="child-toggle"><div class="child-toggle-spacer"></div></div><div class="row-inner">',html+='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="np-icon-sub-menu"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M19 15l-6 6-1.42-1.42L15.17 16H4V4h2v10h9.17l-3.59-3.58L13 9l6 6z" class="arrow" /></svg>',html+='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="handle np-icon-menu"><path d="M0 0h24v24H0z" fill="none" /><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" class="bars" /></svg>',html+='<a href="'+plugin.post.np_link_content+'" class="page-link page-title" target="_blank"><span class="title">'+plugin.post.menuTitle+' <svg class="link-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path class="icon" d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/></svg></span>',html+='</a><div class="action-buttons"><a href="#" class="np-btn np-quick-edit-redirect" ',html+='data-id="'+plugin.post.id+'"',html+='data-parentid="'+plugin.post.parent_id+'"',html+='data-title="'+plugin.post.menuTitle+'" ',html+='data-url="'+plugin.post.url+'" ',html+='data-status="publish" ',html+='data-np-status="show" ',html+='data-navstatus="show" ',html+='data-navcss="'+plugin.post.cssClasses+'" ',html+='data-navtitleattr="'+plugin.post.titleAttribute+'" ',html+='data-nav-type="'+plugin.post.menuType+'" ',html+='data-nav-object="'+plugin.post.objectType+'" ',html+='data-nav-object-id="'+plugin.post.objectId+'" ',html+='data-nav-original-link="'+plugin.post.original_link+'" ',html+='data-nav-original-title="'+plugin.post.original_title+'" ',html+='data-linktarget="'+plugin.post.link_target+'">',html+=NestedPages.jsData.quickEditText,html+="</a>",html+='<a href="'+plugin.post.delete_link+'" class="np-btn np-btn-trash"><i class="np-icon-remove"></i></a>',html+="</div></div></div></li>","0"===plugin.post.parent_id?$(".nplist:first li:first").after(html):plugin.appendChildRow(html),$(document).trigger("close-modal-manual"),plugin.row=$("#menuItem_"+plugin.post.id).find(".row"),plugin.formatter.flashRow(plugin.row)},plugin.appendChildRow=function(html){var parent_row=$("#menuItem_"+plugin.post.parent_id);0===$(parent_row).children("ol").length?(html='<ol class="sortable nplist" style="display:block;">'+html+"</ol>",$(parent_row).append(html)):$(parent_row).find("ol:first").prepend(html),plugin.formatter.updateSubMenuToggle()},plugin.toggleLoading=function(loading){if(loading)return $(plugin.selectors.form).find(plugin.selectors.errorDiv).hide(),$(plugin.selectors.form).find(NestedPages.selectors.quickEditLoadingIndicator).show(),void $(plugin.selectors.saveButton).attr("disabled","disabled");$(plugin.selectors.form).find(NestedPages.selectors.quickEditLoadingIndicator).hide(),$(plugin.selectors.saveButton).attr("disabled",!1)},plugin.bindEvents()},(NestedPages=NestedPages||{}).MenuSearch=function(){var plugin=this,$=jQuery;return plugin.selectors={searchForms:"*[data-np-menu-search]",defaultResults:"[data-default-result]",loadingIndicator:".np-menu-search-loading",noResults:".np-menu-search-noresults",searchType:"data-search-type",searchObject:"data-search-object",searchResults:"[data-np-search-result]"},plugin.activeForm="",plugin.results="",plugin.defaultResults="",plugin.searchType="",plugin.searchObject="",plugin.init=function(){plugin.bindEvents()},plugin.bindEvents=function(){$(document).on("keyup",plugin.selectors.searchForms,(function(){plugin.activeForm=$(this),$(plugin.selectors.searchResults).remove(),plugin.performSearch()}))},plugin.performSearch=function(){if(plugin.defaultResults=$(plugin.activeForm).parent("li").siblings(plugin.selectors.defaultResults),$(plugin.activeForm).val().length>2)return $(plugin.defaultResults).hide(),plugin.toggleLoading(!0),void plugin.query();plugin.toggleLoading(!1),$(plugin.defaultResults).show()},plugin.query=function(){plugin.searchType=$(plugin.activeForm).attr(plugin.selectors.searchType),plugin.searchObject=$(plugin.activeForm).attr(plugin.selectors.searchObject),$.ajax({url:NestedPages.jsData.ajaxurl,type:"post",datatype:"json",data:{action:NestedPages.formActions.search,nonce:NestedPages.jsData.nonce,term:$(plugin.activeForm).val(),searchType:plugin.searchType,searchObject:plugin.searchObject},success:function(data){console.log(data),data.results?(plugin.results=data.results,plugin.toggleLoading(!1),"post_type"===plugin.searchType?plugin.appendPosts():plugin.appendTaxonomies()):(plugin.toggleLoading(!1),$(plugin.activeForm).siblings(plugin.selectors.noResults).show())}})},plugin.appendPosts=function(){var html="";$.each(plugin.results,(function(i,v){html+='<li data-np-search-result><a href="#" data-np-menu-object="'+plugin.searchObject+'" data-np-menu-type="post_type" data-np-menu-objectid="'+v.ID+'" data-np-permalink="'+v.permalink+'" data-np-object-name="'+v.singular_name+'" data-np-menu-selection>'+v.post_title+"</a></li>"})),$(html).insertAfter($(plugin.activeForm).parent("li")),plugin.toggleLoading(!1)},plugin.appendTaxonomies=function(){var html="";$.each(plugin.results,(function(i,v){html+='<li data-np-search-result><a href="#" data-np-menu-object="'+plugin.searchObject+'" data-np-menu-type="post_type" data-np-menu-objectid="'+v.term_id+'" data-np-permalink="'+v.permalink+'" data-np-object-name="'+v.taxonomy+'" data-np-menu-selection>'+v.name+"</a></li>"})),$(html).insertAfter($(plugin.activeForm).parent("li")),plugin.toggleLoading(!1)},plugin.toggleLoading=function(loading){var loadingIndicator=$(plugin.activeForm).siblings(plugin.selectors.loadingIndicator);$(plugin.selectors.noResults).hide(),loading?$(loadingIndicator).show():$(loadingIndicator).hide()},plugin.init()},jQuery(document).ready((function(){new NestedPagesTrash}));var NestedPagesTrash=function(){var plugin=this,$=jQuery;return plugin.trashButton=".np-empty-trash",plugin.confirmButton=".np-trash-confirm",plugin.warningModal="#np-trash-modal",plugin.errorAlert="#np-error",plugin.loadingIndicator="#nested-loading",plugin.trashLinks=".np-trash-links",plugin.postType=$("#np-trash-posttype").val(),plugin.nonce=nestedpages.np_nonce,plugin.formAction="npEmptyTrash",plugin.bindEvents=function(){$(document).on("click",plugin.confirmButton,(function(e){e.preventDefault(),plugin.confirmEmpty()}))},plugin.confirmEmpty=function(){plugin.loading(!0),$(document).trigger("close-modal-manual"),$(plugin.errorAlert).hide(),plugin.emptyTrash()},plugin.emptyTrash=function(){$.ajax({url:ajaxurl,type:"post",datatype:"json",data:{action:plugin.formAction,nonce:plugin.nonce,posttype:plugin.postType},success:function(data){plugin.loading(!1),"error"===data.status?$(plugin.errorAlert).text(data.message).show():($(plugin.trashLinks).hide(),$(".notice-dismiss").click())}})},plugin.loading=function(loading){loading?$(plugin.loadingIndicator).show():$(plugin.loadingIndicator).hide()},plugin.bindEvents()},NestedPages,NestedPages,NestedPages,NestedPages,NestedPages,NestedPages;(NestedPages=NestedPages||{}).ConfirmDelete=function(){var plugin=this,$=jQuery;return plugin.deleteLink="",plugin.bindEvents=function(){$(document).on("click",NestedPages.selectors.linkDeleteButton,(function(e){e.preventDefault(),plugin.confirmSingle($(this))})),$(document).on("click",NestedPages.selectors.linkDeleteConfirmationButton,(function(e){e.preventDefault(),$(this).hasClass("bulk")?plugin.deleteMultiple():plugin.deleteSingle()})),$(document).on("submit",NestedPages.selectors.bulkActionsForm,(function(e){plugin.confirmMultiple(e)}))},plugin.confirmSingle=function(button){plugin.deleteLink=$(button).attr("href"),$(NestedPages.selectors.linkDeleteConfirmationModalText).text(nestedpages.link_delete_confirmation_singular),$(NestedPages.selectors.linkDeleteConfirmationButton).text(nestedpages.delete).removeClass("bulk"),$(document).trigger("open-modal-manual",NestedPages.selectors.linkDeleteConfirmationModal)},plugin.confirmMultiple=function(event){var linkCount;"trash"===$('select[name="np_bulk_action"]').val()&&(""!==$(NestedPages.selectors.bulkActionRedirectIds).val()&&(event.preventDefault(),$(NestedPages.selectors.linkDeleteConfirmationModalText).text(nestedpages.link_delete_confirmation),$(NestedPages.selectors.linkDeleteConfirmationButton).text(nestedpages.trash_delete_links).addClass("bulk"),$(document).trigger("open-modal-manual",[NestedPages.selectors.linkDeleteConfirmationModal])))},plugin.deleteMultiple=function(){$(NestedPages.selectors.bulkActionsForm)[0].submit()},plugin.deleteSingle=function(){window.location.replace(plugin.deleteLink)},plugin.bindEvents()},(NestedPages=NestedPages||{}).ManualSync=function(){var plugin=this,$=jQuery;return plugin.activeBtn="",plugin.bindEvents=function(){$(document).on("click",NestedPages.selectors.manualMenuSync,(function(e){e.preventDefault(),plugin.activeBtn=$(this),plugin.syncMenu()})),$(document).on("click",NestedPages.selectors.manualOrderSync,(function(e){e.preventDefault(),plugin.activeBtn=$(this),plugin.syncOrder()}))},plugin.syncMenu=function(){plugin.loading(!0),$.ajax({url:ajaxurl,type:"post",datatype:"json",data:{action:NestedPages.formActions.manualMenuSync,nonce:NestedPages.jsData.nonce,post_type:NestedPages.jsData.posttype,syncmenu:"sync"},success:function(data){"error"===data.status?($(NestedPages.selectors.errorDiv).text(data.message).show(),$(NestedPages.selectors.loadingIndicator).hide()):plugin.loading(!1)}})},plugin.syncOrder=function(){var nestingClass;plugin.loading(!0),(new NestedPages.Nesting).syncNesting(!0,plugin.loading(!1))},plugin.loading=function(loading){if(loading)return $(plugin.activeBtn).addClass("disabled"),void $(NestedPages.selectors.loadingIndicator).show();$(plugin.activeBtn).removeClass("disabled"),$(NestedPages.selectors.loadingIndicator).hide()},plugin.bindEvents()},(NestedPages=NestedPages||{}).PostSearch=function(){var plugin=this,$=jQuery;return plugin.selectors={input:"data-nestedpages-post-search",form:"data-nestedpages-post-search-form",loadingIndicator:"data-nestedpages-loading",noResults:"data-nestedpages-no-results",results:"data-nestedpages-search-results"},plugin.changed=!1,plugin.activeInput="",plugin.results="",plugin.defaultResults="",plugin.postType="",plugin.activeForm="",plugin.bindEvents=function(){$("["+plugin.selectors.input+"]").on("input",(function(){if(plugin.activeInput=$(this),plugin.setOptions(),plugin.changed||plugin.setDefaultResults(),""===$(this).val())return $(plugin.activeForm).find("["+plugin.selectors.noResults+"]").hide(),void plugin.showDefaultResults();plugin.query()}))},plugin.setDefaultResults=function(){plugin.defaultResults=$(plugin.activeForm).find("["+plugin.selectors.results+"]").html(),plugin.changed=!0},plugin.showDefaultResults=function(){$(plugin.activeForm).find("["+plugin.selectors.results+"]").html(plugin.defaultResults)},plugin.setOptions=function(){plugin.postType=$(plugin.activeInput).attr(plugin.selectors.input),plugin.activeForm=$(plugin.activeInput).parents("["+plugin.selectors.form+"]")},plugin.performSearch=function(){if(plugin.defaultResults=$(plugin.activeForm).parent("li").siblings(plugin.selectors.defaultResults),$(plugin.activeForm).val().length>2)return $(plugin.defaultResults).hide(),plugin.toggleLoading(!0),void plugin.query();plugin.toggleLoading(!1),$(plugin.defaultResults).show()},plugin.query=function(){$(plugin.activeForm).find("["+plugin.selectors.results+"]").empty(),plugin.toggleLoading(!0),$.ajax({url:NestedPages.jsData.ajaxurl,type:"post",datatype:"json",data:{action:NestedPages.formActions.postSearch,nonce:NestedPages.jsData.nonce,term:$(plugin.activeInput).val(),postType:plugin.postType},success:function(data){data.results?(plugin.results=data.results,plugin.loadResults(),plugin.toggleLoading(!1)):(plugin.toggleLoading(!1),$(plugin.activeForm).find("["+plugin.selectors.noResults+"]").show())}})},plugin.loadResults=function(){var html="<ul>";$.each(plugin.results,(function(i,v){html+='<li><a href="#" data-assignment-page-id="'+v.ID+'" data-assignment-page-title="'+v.post_title+'">'+v.post_title+"</a></li>"})),html+="</ul>",$(plugin.activeForm).find("["+plugin.selectors.results+"]").html(html),plugin.toggleLoading(!1)},plugin.toggleLoading=function(loading){var loadingIndicator=$(plugin.activeForm).find("["+plugin.selectors.loadingIndicator+"]"),noResults=$(plugin.activeForm).find("["+plugin.selectors.noResults+"]");$(noResults).hide(),loading?$(loadingIndicator).show():$(loadingIndicator).hide()},plugin.bindEvents()},(NestedPages=NestedPages||{}).MovePost=function(){var plugin=this,$=jQuery;return plugin.formatter=new NestedPages.Formatter,plugin.nesting=new NestedPages.Nesting,plugin.activeRow,plugin.selectors={moveToTop:"data-push-to-top",moveToBottom:"data-push-to-bottom"},plugin.bindEvents=function(){$(document).ready((function(){plugin.disableTopOnFirst(),plugin.disableBottomOnLast()})),$(document).on("click","["+plugin.selectors.moveToTop+"]",(function(e){e.preventDefault(),$(this).hasClass("disabled")||(plugin.activeRow=$(this).closest(NestedPages.selectors.rows),plugin.moveToTop())})),$(document).on("click","["+plugin.selectors.moveToBottom+"]",(function(e){e.preventDefault(),$(this).hasClass("disabled")||(plugin.activeRow=$(this).closest(NestedPages.selectors.rows),plugin.moveToBottom())}))},plugin.moveToTop=function(){var parent=$(plugin.activeRow).parent(NestedPages.selectors.lists),first=$(parent).find(NestedPages.selectors.rows).first();$(plugin.activeRow).insertBefore(first),plugin.formatter.setBorders(),$(document).click(),plugin.nesting.syncNesting(),plugin.disableTopOnFirst(),plugin.disableBottomOnLast()},plugin.moveToBottom=function(){var parent=$(plugin.activeRow).parent(NestedPages.selectors.lists),last=$(parent).children(NestedPages.selectors.rows).last();$(plugin.activeRow).insertAfter(last),plugin.formatter.setBorders(),$(document).click(),plugin.nesting.syncNesting(),plugin.disableTopOnFirst(),plugin.disableBottomOnLast()},plugin.disableTopOnFirst=function(){var lists=$(NestedPages.selectors.lists);$.each(lists,(function(){$(this).find("["+plugin.selectors.moveToTop+"]").removeClass("disabled");var first=$(this).find(NestedPages.selectors.rows).first();$(first).find("["+plugin.selectors.moveToTop+"]").addClass("disabled")}))},plugin.disableBottomOnLast=function(){var lists=$(NestedPages.selectors.lists);$.each(lists,(function(){$(this).find("["+plugin.selectors.moveToBottom+"]").removeClass("disabled");var last=$(this).find(NestedPages.selectors.rows).last();$(last).find("["+plugin.selectors.moveToBottom+"]").addClass("disabled")}))},plugin.bindEvents()},(NestedPages=NestedPages||{}).TrashWithChildren=function(){var plugin=this,$=jQuery;return plugin.post_id="",plugin.bindEvents=function(){$(document).on("click",NestedPages.selectors.trashWithChildrenButton,(function(e){e.preventDefault(),plugin.post_id=$(this).attr("data-post-id"),plugin.trash()}))},plugin.trash=function(){$.ajax({url:NestedPages.jsData.ajaxurl,type:"post",data:{action:NestedPages.formActions.trashWithChildren,nonce:NestedPages.jsData.nonce,post_id:plugin.post_id,screen:nestedpages.current_page},success:function(data){window.location.replace(data.redirect)},error:function(data){console.log(data)}})},plugin.bindEvents()},(NestedPages=NestedPages||{}).Wpml=function(){var plugin=this,$=jQuery;return plugin.button=null,plugin.postData=null,plugin.modal=null,plugin.parent_li=null,plugin.formatter=new NestedPages.Formatter,plugin.selectors={translationsBtn:"data-nestedpages-translations",modal:"data-np-wpml-translations-modal",title:"data-wmpl-translation-title",table:"data-np-wpml-translations-modal-table"},plugin.bindEvents=function(){nestedpages.wpml&&$(document).on("click","["+plugin.selectors.translationsBtn+"]",(function(e){e.preventDefault(),plugin.createTranslationsModal($(this))}))},plugin.createTranslationsModal=function(button){if(plugin.parent_li=$(button).parents(".action-buttons").closest(NestedPages.selectors.row).parent("li"),plugin.button=$(plugin.parent_li).find(NestedPages.selectors.quickEditOpen),plugin.postData={id:$(plugin.button).attr("data-id"),title:$(plugin.button).attr("data-title"),slug:$(plugin.button).attr("data-slug")},plugin.modal=$("["+plugin.selectors.modal+"]").clone(),$(plugin.parent_li).children("ol").length>0){var child_ol=$(plugin.parent_li).children("ol");$(plugin.modal).insertBefore(child_ol)}else $(plugin.modal).appendTo(plugin.parent_li);$(plugin.modal).find("["+plugin.selectors.title+"]").text(plugin.postData.title),plugin.formatter.showQuickEdit(),$(plugin.modal).show(),plugin.getTranslationData()},plugin.getTranslationData=function(){$.ajax({url:NestedPages.jsData.ajaxurl,type:"post",datatype:"json",data:{action:NestedPages.formActions.wpmlTranslations,post_id:plugin.postData.id,nonce:NestedPages.jsData.nonce},success:function(data){console.log(data),console.log(plugin.postData.id),"success"===data.status?plugin.populateModal(data.translations):($(plugin.modal).find(NestedPages.selectors.quickEditErrorDiv).text(data.message).show(),plugin.toggleLoading(!1))}})},plugin.populateModal=function(translations){var html="<tbody>";$.each(translations,(function(i,v){var translation=translations[i];html+="<tr>",html+='<td><img src="'+translation.country_flag_url+'" alt="'+translation.translated_name+'" /> '+translation.translated_name+"</td>",html+="<td>",translation.has_translation&&translation.edit_link?html+='<a href="'+translation.edit_link+'">'+translation.translation.post_title+" ("+nestedpages.edit+")</a>":html+='<a href="'+translation.add_link+'" class="np-btn">+ '+nestedpages.add_translation+"</a>",html+="</td>",html+="</tr>"})),html+="</tbody>",$(plugin.modal).find("["+plugin.selectors.table+"]").html(html),plugin.toggleLoading(!1)},plugin.toggleLoading=function(loading){loading?$(plugin.modal).addClass("loading"):$(plugin.modal).removeClass("loading")},plugin.bindEvents()};